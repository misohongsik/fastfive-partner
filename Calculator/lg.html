<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LG U+ ê²°í•© í• ì¸ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Embedded CSS */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; /* slate-50 */ }
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #334155; /* slate-700 */ }
        .input-field, .select-field { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #cbd5e1; /* slate-300 */ border-radius: 0.375rem; box-shadow: sm; transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
        .input-field:focus, .select-field:focus { border-color: #ec4899; /* pink-500 */ outline: none; box-shadow: 0 0 0 0.2rem rgba(236, 72, 153, 0.25); }
        .input-field:disabled, .select-field:disabled { background-color: #e2e8f0; /* slate-200 */ cursor: not-allowed; opacity: 0.7; }
        .btn-primary { background-color: #ec4899; /* pink-500 */ color: white; padding: 0.75rem 1.5rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.3s ease; }
        .btn-primary:hover { background-color: #db2777; /* pink-600 */ }
        .btn-primary:disabled { background-color: #f472b6; cursor: not-allowed; }
        .btn-secondary { background-color: #64748b; /* slate-500 */ color: white; padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; transition: background-color 0.3s ease; }
        .btn-secondary:hover { background-color: #475569; /* slate-600 */ }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #c026d3; /* fuchsia-600 */ margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #f0abfc /* fuchsia-300 */;}
        .result-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); margin-bottom: 1.5rem; }
        .result-label { color: #475569; /* slate-600 */ }
        .result-value { color: #1e293b; /* slate-800 */ font-weight: 600;}
        .total-value { color: #d946ef; /* fuchsia-500 */ font-size: 1.5rem; font-weight: 700;}
        .mobile-line-item { border: 1px solid #e2e8f0; /* slate-200 */ padding: 1rem; border-radius: 0.375rem; margin-bottom: 0.75rem; }
        .radio-label { margin-right: 1rem; margin-bottom: 0.5rem; display: inline-flex; align-items: center; cursor: pointer;}
        .radio-input { margin-right: 0.5rem; accent-color: #ec4899; /* pink-500 */ }
        .info-box { background-color: #fefce8; /* yellow-50 */ border-left: 4px solid #eab308; /* yellow-500 */ padding: 1rem; margin-bottom:1.5rem; font-size: 0.875rem; color: #713f12; /* yellow-800 */}
        .info-box a { color: #854d0e; font-weight: 500; text-decoration: underline;}
        .info-box a:hover { color: #713f12;}
        .info-box ul { padding-left: 1.25rem; list-style-type: disc; margin-top: 0.5rem;}
        .info-box ul ul { padding-left: 1rem; list-style-type: circle;}
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 20px; margin-left: 10px; vertical-align: middle;}
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px;}
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%;}
        input:checked + .slider { background-color: #ec4899; /* pink-500 */ }
        input:checked + .slider:before { transform: translateX(20px); }
        .discount-details { background-color: #fce7f3; /* pink-100 */ border: 1px solid #f9a8d4; /* pink-300 */ padding: 1rem; border-radius: 0.375rem; font-size:0.875rem; }
        .discount-details ul { padding-left: 1.25rem; list-style-type: disc; margin-left: 0.5rem;}
        .discount-details ul ul { padding-left: 1rem; list-style-type: circle; }
        .discount-details table { width: 100%; margin-bottom: 0.5rem; border-collapse: collapse; }
        .discount-details th, .discount-details td { padding: 0.35rem 0.5rem; text-align: center; border: 1px solid #fbcfe8; /* pink-200 */ font-size: 0.75rem; }
        .discount-details th { background-color: #fdf2f8; /* pink-50 */ font-weight: 600; }
        .summary-item { margin-bottom: 0.25rem; }
        .message-script-area { width: 100%; min-height: 100px; padding: 0.5rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; font-size: 0.875rem; white-space: pre-wrap; word-wrap: break-word; }
        .copy-button-container { text-align: right; margin-top: 0.5rem; }
        .copy-feedback { font-size: 0.75rem; color: green; margin-left: 0.5rem; }
        .hidden { display: none !important; }

        /* New Styles for 2-column Summary Card */
        .summary-card-main {
            background-color: #fff;
            border: 2px solid #ec4899; /* pink-500 */
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem; /* Increased gap between columns */
        }

        .summary-column {
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Increased gap between items in a column */
        }

        .summary-item-block {
            background-color: #f8fafc; /* slate-50 */
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
        }

        .summary-item-label {
            font-size: 1rem; /* text-base */
            font-weight: 500; /* font-medium */
            color: #475569; /* slate-600 */
            margin-bottom: 0.25rem;
        }

        .summary-item-value {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #c026d3; /* fuchsia-600 */
            line-height: 1.1;
        }

        .pre-discount-price {
            font-size: 0.875rem; /* text-sm */
            color: #64748b; /* slate-500 */
            text-decoration: line-through;
            margin-bottom: 0.25rem;
        }

        .discount-value {
            color: #2563eb; /* blue-600 */
        }

        .gift-value {
            color: #16a34a; /* green-600 */
        }

        .discount-reason {
            margin-top: 1rem;
            padding: 0.75rem;
            background-color: #fefce8; /* yellow-50 */
            border-radius: 0.375rem;
            font-size: 0.875rem;
            color: #854d0e; /* yellow-800 */
            text-align: center;
            border-left: 4px solid #f59e0b; /* amber-500 */
            grid-column: 1 / -1; /* Make it span both columns */
        }
        .btn-ai {
            background-color: #0ea5e9; /* sky-500 */
        }
        .btn-ai:hover {
            background-color: #0284c7; /* sky-600 */
        }
        .btn-ai:disabled {
            background-color: #7dd3fc; /* sky-300 */
            cursor: not-allowed;
        }
    </style>
</head>
<body class="text-slate-800">
    <header class="bg-pink-700 text-white p-6 shadow-md">
        <div class="container mx-auto max-w-4xl flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold">ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„°</h1>
                <p class="text-pink-200 mt-1">LG U+ ê²°í•© í• ì¸ ê³„ì‚°ê¸°</p>
            </div>
            <div class="flex items-center">
                <span class="text-sm mr-2">VATë³„ë„</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="vatToggle">
                    <span class="slider"></span>
                </label>
                <span class="text-sm ml-2">VATí¬í•¨</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <section id="inputSection" class="mb-8">
            <div class="info-box">
                <p class="font-semibold text-amber-700">âš ï¸ ë¯¼ê°ì •ë³´</p>
                <p><a href="https://lg-sensitiveinfo.com/" target="_blank">https://lg-sensitiveinfo.com/</a></p>
                <p class="text-sm">ã„´> ìœ„ ë§í¬ë¥¼ ê³ ê°ì—ê²Œ ë¬¸ìë¡œ ì „ì†¡í•´ì£¼ì„¸ìš”. (ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬ ê¸°ëŠ¥ ì´ìš©)</p>
                <hr class="my-2 border-yellow-300">
                <p><strong>ì°¸ê³  ìŠ¤í”„ë ˆë“œì‹œíŠ¸:</strong> <a href="https://docs.google.com/spreadsheets/d/10d21RrhIPBiJr7RZIHnk0h1dB4GvTEcHCuXSyFYw1M4/edit?gid=0#gid=0" target="_blank">ë°”ë¡œê°€ê¸°</a></p>
            </div>

            <h2 class="section-title">1. ì„œë¹„ìŠ¤ ì„ íƒ (3ë…„ ì•½ì • ê¸°ì¤€, VAT í¬í•¨)</h2>
            <p class="mb-6 text-sm text-slate-600">ì•„ë˜ í•­ëª©ë“¤ì„ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”. ëª¨ë“  ìš”ê¸ˆì€ LG U+ í‘œì¤€ 3ë…„ ì•½ì •, ë¶€ê°€ì„¸ í¬í•¨ ì •ê°€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
            
            <div class="input-group">
                <label class="input-label">ì¸í„°ë„· ìœ í˜• ì„ íƒ</label>
                <div class="flex items-center space-x-4">
                    <label class="radio-label"><input type="radio" name="internetType" value="bundle" class="radio-input" checked> ì¸í„°ë„· + TV ë²ˆë“¤</label>
                    <label class="radio-label"><input type="radio" name="internetType" value="standalone" class="radio-input"> ì¸í„°ë„· ë‹¨ë…</label>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="input-group">
                    <label for="internetPlan" class="input-label">ì¸í„°ë„· ìš”ê¸ˆì œ</label>
                    <select id="internetPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                    <p class="text-xs text-slate-500 mt-1" id="internetNotes">ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨.</p>
                </div>
                
                <div class="input-group">
                    <label for="tvPlan" class="input-label">U+tv ìš”ê¸ˆì œ (1ë²ˆì§¸ TV)</label>
                    <select id="tvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                     <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : ìœ„ ìš”ê¸ˆì€ ì…‹í†±ë°•ìŠ¤ í¬í•¨, ì¸í„°ë„· ê²°í•© ì‹œ 3ë…„ ì•½ì • ê¸°ì¤€ì…ë‹ˆë‹¤.</p>
                </div>

                <div class="input-group hidden" id="tvStbGroup"> 
                    <label for="tvStb" class="input-label">U+tv ì…‹í†±ë°•ìŠ¤ (1ë²ˆì§¸ TV)</label>
                    <select id="tvStb" class="select-field">
                        <option value="UHD4" data-price="0">UHD4 (ê¸°ë³¸ í¬í•¨ ê°€ì •)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="additionalTvPlan" class="input-label">ì¶”ê°€ U+tv ì„ íƒ (2ë²ˆì§¸ TV)</label>
                    <select id="additionalTvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                      <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : ì¶”ê°€ TV ìš”ê¸ˆì€ í”Œëœê³¼ ì…‹í†±ë°•ìŠ¤ ì„ëŒ€ë£Œê°€ í¬í•¨ëœ ì´ ê¸ˆì•¡ì…ë‹ˆë‹¤.</p>
                </div>
                
                <div class="input-group">
                    <label for="phonePlan" class="input-label">ì¸í„°ë„·ì „í™” ìš”ê¸ˆì œ (ì„ íƒ)</label>
                    <select id="phonePlan" class="select-field">
                        <option value="none" selected>ì„ íƒ ì•ˆí•¨</option>
                    </select>
                </div>
            </div>

            <div class="input-group mt-6">
                <label class="input-label">ëª¨ë°”ì¼ íšŒì„  ì •ë³´ (ê²°í•© í• ì¸ì— ì˜í–¥)</label>
                <div class="flex items-center mb-2">
                    <label for="mobileLinesCount" class="mr-2 text-sm text-slate-700">ê²°í•©í•  ëª¨ë°”ì¼ íšŒì„  ìˆ˜:</label>
                    <input type="number" id="mobileLinesCount" min="0" max="10" value="0" class="input-field w-20 text-center">
                </div>
                <div id="mobileLinesContainer" class="space-y-3"></div>
                 <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : 'ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©'ì€ ìµœëŒ€ 10íšŒì„ , 'íˆ¬ê²Œë” ê²°í•©'ì€ ìµœëŒ€ 5íšŒì„ ê¹Œì§€ íœ´ëŒ€í° ê²°í•© ê°€ëŠ¥.</p>
            </div>
        </section>

        <section id="discountTypeSection" class="mb-8">
            <h2 class="section-title">2. ê²°í•© í• ì¸ ìœ í˜• ì„ íƒ</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <p class="mb-4 text-sm text-slate-600">ê°€ì¥ ìœ ë¦¬í•œ í• ì¸ ìœ í˜•ì„ ì„ íƒí•˜ê±°ë‚˜, ê° ìœ í˜•ë³„ ì˜ˆìƒ ìš”ê¸ˆì„ ë¹„êµí•´ë³´ì„¸ìš”. (ì¸í„°ë„· ìš”ê¸ˆ í• ì¸ ê¸°ì¤€)</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2">
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="none" class="radio-input" checked> ê²°í•©í• ì¸ ì—†ìŒ</label>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="cham_family" class="radio-input"> ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="chamFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="together_bundle" class="radio-input"> íˆ¬ê²Œë” ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="togetherDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="internet_family_all_together" class="radio-input"> ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬ ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="internetFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="mvno_bundle" class="radio-input"> ì•Œëœ°í° ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mvnoLGUDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                </div>

                <div id="chamFamilyDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailCfInternetDiscount" class="font-bold">0</span>ì›</p>
                    <p>ì˜ˆìƒ íœ´ëŒ€í° ì´ í• ì¸: <span id="detailCfMobileDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">â–  í•µì‹¬ í˜œíƒ</p>
                    <p class="text-xs mb-2">ì¡°ê±´ ì—†ì´ ê°€ì¡±ì´ ëª¨ì´ë©´ í• ì¸ì„ ë°›ëŠ” ê²°í•© ìƒí’ˆì…ë‹ˆë‹¤.</p>
                    <table>
                        <thead>
                            <tr>
                                <th rowspan="2">ê²°í•©<br>íœ´ëŒ€í° ìˆ˜</th>
                                <th colspan="3">íœ´ëŒ€í° í• ì¸ (ì›”)</th>
                                <th colspan="3">ì¸í„°ë„· í• ì¸ (ì›”)</th>
                            </tr>
                            <tr>
                                <th>~6.9ë§Œ</th>
                                <th>6.9ë§Œ~</th>
                                <th>8.8ë§Œ~</th>
                                <th>100M</th>
                                <th>500M</th>
                                <th>1G</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1ëŒ€</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>5,500ì›</td>
                                <td>9,900ì›</td>
                                <td>13,200ì›</td>
                            </tr>
                            <tr>
                                <td>2ëŒ€</td>
                                <td>2,200ì›</td>
                                <td>3,300ì›</td>
                                <td>4,400ì›</td>
                                <td colspan="3" rowspan="3" style="vertical-align:middle;">ìƒë™</td>
                            </tr>
                            <tr>
                                <td>3ëŒ€</td>
                                <td>3,300ì›</td>
                                <td>5,500ì›</td>
                                <td>6,600ì›</td>
                            </tr>
                            <tr>
                                <td>4-10ëŒ€</td>
                                <td>4,400ì›</td>
                                <td>6,600ì›</td>
                                <td>8,800ì›</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ì£¼ìš” ì¡°ê±´ ë° ë²”ìœ„</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ìµœëŒ€ ì¸í„°ë„· 3íšŒì„  + íœ´ëŒ€í° 10íšŒì„  ê²°í•© ê°€ëŠ¥</li>
                        <li>íœ´ëŒ€í°ì€ 2ëŒ€ë¶€í„° í• ì¸ ì ìš©</li>
                        <li>ì¸í„°ë„·ê³¼ íœ´ëŒ€í° ëª…ì˜ì ë‹¬ë¼ë„ ê²°í•© ê°€ëŠ¥ (ê°€ì¡±ê´€ê³„ ì¦ë¹™ í•„ìš”)</li>
                        <li>ì•Œëœ°í° ê²°í•© ì‹œ, ê²°í•© ë‚´ ì•Œëœ°í° íœ´ëŒ€í° ë²ˆí˜¸ ê°œìˆ˜ X U+ íœ´ëŒ€í°ì— 440ì› ì¶”ê°€ í• ì¸ ì œê³µ</li>
                        <li>ê²°í•© ë²”ìœ„: ë°°ìš°ì, ì§ê³„ ì¡´ë¹„ì†(ì•„ë“¤, ë”¸, ì†ì, ì¦ì†), í˜•ì œ, ìë§¤, ì‚¬ìœ„, ë©°ëŠë¦¬, ë°°ìš°ìì˜ ë¶€ëª¨, í˜•ì œ, ìë§¤</li>
                        <li>ë„ˆê²Ÿ ìš”ê¸ˆì œë„ ê²°í•© ê°€ëŠ¥</li>
                    </ul>
                </div>
                <div id="togetherDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">íˆ¬ê²Œë” ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailTgInternetDiscount" class="font-bold">0</span>ì›</p>
                    <p>ì˜ˆìƒ íœ´ëŒ€í° ì´ í• ì¸: <span id="detailTgMobileDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">â–  í•µì‹¬ í˜œíƒ</p>
                    <p class="text-xs mb-2">ê°€ì¡±, ì¹œêµ¬, ì§€ì¸ ëˆ„êµ¬ì™€ë„ ê²°í•©í•˜ì—¬ í• ì¸ë°›ëŠ” ìƒí’ˆì…ë‹ˆë‹¤.</p>
                    <table>
                        <thead>
                            <tr>
                                <th>ê²°í•© íœ´ëŒ€í° ìˆ˜</th>
                                <th>íœ´ëŒ€í° í• ì¸ (ì¸ë‹¹)</th>
                                <th>ì¸í„°ë„· í• ì¸</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2ëŒ€</td>
                                <td>10,000ì›</td>
                                <td rowspan="3" style="vertical-align:middle;">500M ì´ìƒ<br>11,000ì›</td>
                            </tr>
                            <tr>
                                <td>3ëŒ€</td>
                                <td>14,000ì›</td>
                            </tr>
                            <tr>
                                <td>4-5ëŒ€</td>
                                <td>20,000ì›</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ì£¼ìš” ì¡°ê±´</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ìµœëŒ€ ì¸í„°ë„· 5íšŒì„  + íœ´ëŒ€í° 5íšŒì„  ê²°í•© ê°€ëŠ¥</li>
                        <li>ì¸í„°ë„· 500M ì´ìƒ & ëª¨ë“  ê²°í•© íœ´ëŒ€í° 85,000ì› ì´ìƒ ìš”ê¸ˆì œ ì´ìš© ì‹œ ê°€ëŠ¥</li>
                        <li>100M ì¸í„°ë„· ê²°í•© ë¶ˆê°€, 'ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬'ì™€ ì¤‘ë³µ ë¶ˆê°€</li>
                    </ul>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ê²°í•© ìœ í˜•</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li><b>ê°€ì¡± ê²°í•©:</b> ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ í•„ìš”, ìš”ê¸ˆ ê°ì ì²­êµ¬
                            <ul>
                                <li>ë²”ìœ„: ë°°ìš°ì, ì§ê³„ ì¡´ë¹„ì†, í˜•ì œìë§¤, ì‚¬ìœ„/ë©°ëŠë¦¬, ë°°ìš°ìì˜ ë¶€ëª¨/í˜•ì œìë§¤</li>
                            </ul>
                        </li>
                        <li><b>ì§€ì¸ ê²°í•©:</b> ì¹œêµ¬/ì—°ì¸ ë“±, ëŒ€í‘œì 1ì¸ì´ êµ¬ì„±ì› í†µì‹ ë£Œ ëª¨ë‘ ë‚©ë¶€</li>
                    </ul>
                </div>
                 <div id="internetFamilyDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬ ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¶”ê°€ ì¸í„°ë„· í• ì¸ (ìíšŒì„ ): <span id="detailIfInternetDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">â–  í•µì‹¬ í˜œíƒ</p>
                    <p class="text-xs mb-2">ê¸°ì¡´ U+ ì¸í„°ë„· ì‚¬ìš© ê°€ì¡±ì´ ìˆìœ¼ë©´ ì¶”ê°€ íšŒì„ ì— <strong>ì›” 5,500ì›</strong>ì„ í• ì¸í•´ ë“œë¦½ë‹ˆë‹¤.</p>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ì£¼ìš” ì¡°ê±´</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ëª¨íšŒì„  1ê°œ + ìíšŒì„  10ê°œê¹Œì§€ ê²°í•© ê°€ëŠ¥</li>
                        <li>'ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©', 'íˆ¬ê²Œë” ê²°í•©'ê³¼ ì¤‘ë³µ ë¶ˆê°€</li>
                        <li>ê¸°ì¡´ ê²°í•©(ê°€ì¡±ë¬´í•œì‚¬ë‘ ë“±)ì— ìœ ì„  ìƒí’ˆì´ í¬í•¨ë˜ì–´ ìˆì–´ì•¼ ê°€ëŠ¥ (ë¬´ì„ ë§Œ ìˆëŠ” ê²½ìš° ë¶ˆê°€)</li>
                        <li><strong class="text-red-600">'ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©' ë˜ëŠ” 'íˆ¬ê²Œë” ê²°í•©' í• ì¸ì„ ë°›ê³  ìˆëŠ” ì¸í„°ë„·ì„ ëª¨íšŒì„ ìœ¼ë¡œ ì§€ì •í•˜ì—¬ 'ê°€ì¡±ë¼ë¦¬ëª¨ì—¬' ê²°í•© ì§„í–‰ì€ ë¶ˆê°€í•©ë‹ˆë‹¤.</strong></li>
                    </ul>
                </div>
                <div id="mvnoLGUDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì•Œëœ°í° ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailMvnoLGUInternetDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">â–  í•µì‹¬ í˜œíƒ</p>
                    <p class="text-xs mb-2">U+ë§ ì•Œëœ°í° ì´ìš© ì‹œ ì¸í„°ë„· ìš”ê¸ˆì„ í• ì¸í•´ ë“œë¦½ë‹ˆë‹¤. (íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸ì€ ì—†ìŒ)</p>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ì¸í„°ë„· í• ì¸ì•¡</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>100M ì¸í„°ë„· ê²°í•© ì‹œ: 5,500ì› í• ì¸</li>
                        <li>500M ì¸í„°ë„· ê²°í•© ì‹œ: 9,900ì› í• ì¸</li>
                        <li>1G ì¸í„°ë„· ê²°í•© ì‹œ: 13,200ì› í• ì¸</li>
                    </ul>
                    <p class="text-xs mt-3 mb-1 text-pink-700 font-semibold">â–  ì£¼ìš” ì¡°ê±´</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ì§€ì •ëœ U+ë§ ì•Œëœ°í° í†µì‹ ì‚¬ ë° ìš”ê¸ˆì œë§Œ ê²°í•© ê°€ëŠ¥</li>
                        <li>ì¼ë°˜ LG U+ íœ´ëŒ€í°ê³¼ í•¨ê»˜ ê²°í•© ê°€ëŠ¥ ('ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©' ë‚´ì—ì„œ í• ì¸ ì ìš©)</li>
                        <li><strong>ì•Œëœ°í° ê²°í•© ì§„í–‰ ì‹œ, ê¼­ LG ê³ ê°ì„¼í„°ë¥¼ í†µí•´ ê²°í•© ê°€ëŠ¥í•œ ìš”ê¸ˆì œì¸ì§€ ê³ ê°ë‹˜ì´ ì§ì ‘ í™•ì¸ í›„ ë³€ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤.</strong></li>
                    </ul>
                </div>
            </div>
        </section>


        <section id="commissionSection" class="mb-8">
            <h2 class="section-title">3. ìˆ˜ìˆ˜ë£Œ ì •ì±… ì„ íƒ (OTTìƒí’ˆìš©)</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="input-group">
                    <label for="commissionPolicy" class="input-label">íŒë§¤ìˆ˜ìˆ˜ë£Œ ì„ íƒ</label>
                    <select id="commissionPolicy" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                </div>
            </div>
        </section>

        <section id="affiliateCardSection" class="mb-8">
            <h2 class="section-title">4. ì œíœ´ì¹´ë“œ í• ì¸ ì„ íƒ (ì„ íƒì‚¬í•­)</h2>
            <div class="bg-white p-6 rounded-lg shadow grid md:grid-cols-2 gap-6">
                <div class="input-group">
                    <label for="affiliateCard" class="input-label">ì œíœ´ì¹´ë“œ ì„ íƒ</label>
                    <select id="affiliateCard" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                </div>
                <div id="cardSpendingTierGroup" class="input-group hidden">
                    <label for="cardSpendingTier" class="input-label">ì „ì›” ì‹¤ì  êµ¬ê°„ ì„ íƒ</label>
                    <select id="cardSpendingTier" class="select-field">
                    </select>
                </div>
            </div>
        </section>

        <section id="installationSection" class="mb-8">
            <h2 class="section-title">5. ì„¤ì¹˜ ì˜µì…˜</h2>
            <div class="input-group bg-white p-6 rounded-lg shadow">
                <label class="input-label">ì„¤ì¹˜ í¬ë§ ì‹œì  (ì„¤ì¹˜ë¹„ ë³€ë™)</label>
                <div class="space-y-2">
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekday" class="radio-input" checked> í‰ì¼ ì£¼ê°„</label>
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekend" class="radio-input"> ì£¼ë§/ì•¼ê°„ (í• ì¦ ì ìš©)</label>
                </div>
                <div class="mt-4">
                    <label class="radio-label"><input type="checkbox" id="installationFeeSelfPay" class="radio-input"> ì„¤ì¹˜ë¹„ ìì²´ì§€ê¸‰</label>
                </div>
            </div>
        </section>

        <div class="text-center mb-8">
            <button id="calculateButton" class="btn-primary text-lg">ì˜ˆìƒ ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
            <button id="resetButton" class="btn-secondary text-lg ml-4">ì´ˆê¸°í™”</button>
        </div>

        <section id="resultSection" class="hidden">
            <h2 class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>
            
            <div class="summary-card-main">
                <div class="summary-column">
                    <div class="summary-item-block">
                        <p class="pre-discount-price"><span id="preDiscountWiredFeeEl">0</span> ì›</p>
                        <p class="summary-item-label">ì›” ìœ ì„  ìš”ê¸ˆ (ê²°í•©í• ì¸ í›„)</p>
                        <p class="summary-item-value"><span id="finalWiredFeeEl">0</span> ì›</p>
                    </div>
                     <div class="summary-item-block">
                        <p class="summary-item-label">ì œíœ´ì¹´ë“œ í• ì¸</p>
                        <p class="summary-item-value discount-value">- <span id="cardDiscountEl">0</span> ì›</p>
                    </div>
                </div>
                <div class="summary-column">
                    <div class="summary-item-block">
                        <p class="summary-item-label">í˜„ê¸ˆ ì‚¬ì€í’ˆ</p>
                        <p class="summary-item-value gift-value"><span id="giftAmountEl">0</span> ì›</p>
                    </div>
                    <div class="summary-item-block">
                        <p class="summary-item-label">íœ´ëŒ€í° ì´ í• ì¸</p>
                        <p class="summary-item-value discount-value">- <span id="mobileDiscountEl">0</span> ì›</p>
                    </div>
                </div>
            </div>
            <p id="discountReason" class="discount-reason hidden"></p>
            
            <div class="text-center my-4">
                <button id="detailsToggleButton" class="btn-secondary text-sm">ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼</button>
            </div>

            <div id="detailsContainer" class="hidden">
                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ìš”ê¸ˆ ìš”ì•½ (VAT í¬í•¨)</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <p class="result-label summary-item">ì„ íƒ ì¸í„°ë„·: <span id="selectedInternet" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ U+tv (1ë²ˆì§¸): <span id="selectedTv" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ ì¶”ê°€ U+tv (2ë²ˆì§¸): <span id="selectedAdditionalTv" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ ì¸í„°ë„·ì „í™”: <span id="selectedPhone" class="result-value"></span></p>
                            <p class="result-label summary-item">ëª¨ë°”ì¼ íšŒì„  ìˆ˜: <span id="selectedMobileCount" class="result-value"></span></p>
                            <p class="result-label summary-item">ì ìš© í• ì¸ ìœ í˜•: <span id="selectedDiscountType" class="result-value"></span></p>
                        </div>
                        <div>
                            <p class="result-label summary-item">ì›” ìœ ì„ ìƒí’ˆ ê¸°ë³¸ë£Œ: <span id="totalBaseWiredCost" class="result-value">0</span> ì›</p>
                            <p class="result-label text-green-600 summary-item">ì›” ì´ ê²°í•© í• ì¸ì•¡: <span id="totalInternetDiscountAmount" class="result-value text-green-600">0</span> ì›</p>
                            <p class="result-label text-blue-600 summary-item">ì›” ì œíœ´ì¹´ë“œ í• ì¸ì•¡: <span id="totalCardDiscountAmount" class="result-value text-blue-600">0</span> ì›</p>
                            
                            <hr class="my-1 border-pink-300">
                            <p class="mt-2 text-lg font-semibold">ìµœì¢… ì˜ˆìƒ ì›” ë‚©ë¶€ì•¡ (ìœ ì„ ìƒí’ˆ): <span id="finalMonthlyCost" class="total-value">0</span> ì›</p>
                        </div>
                    </div>

                    <div id="mobileDiscountDetailsContainer" class="mt-6 hidden">
                        <h4 class="text-lg font-semibold text-pink-600 mb-2 border-t pt-4">ëª¨ë°”ì¼ ìš”ê¸ˆ í• ì¸ ìƒì„¸</h4>
                        <div id="mobileDiscountResultList" class="space-y-2 text-sm"></div>
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ğŸ ì‚¬ì€í’ˆ í˜œíƒ (ì˜ˆìƒ í˜„ê¸ˆ)</h3>
                    <p class="result-label summary-item">í˜„ê¸ˆ ì‚¬ì€í’ˆ: <span id="giftCash" class="result-value">0</span> ì›</p>
                     <p class="text-xs text-pink-500 mt-1">* ì‚¬ì€í’ˆ ì •ë³´ëŠ” ë³€ë™ë  ìˆ˜ ìˆìœ¼ë‹ˆ ê°€ì… ì‹œì ì— ë°˜ë“œì‹œ ì¬í™•ì¸ ë°”ëë‹ˆë‹¤.</p>
                </div>

                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ì´ˆê¸° ì„¤ì¹˜ ë¹„ìš© (ì„ íƒí•œ ëª¨ë“  ìœ ì„  ì„œë¹„ìŠ¤ ê¸°ì¤€)</h3>
                    <p class="result-label">ì˜ˆìƒ ì´ ì„¤ì¹˜ë¹„: <span id="installationCostResult" class="result-value text-lg">0</span> ì›</p>
                    <p class="text-xs text-slate-500 mt-1">* ì„ íƒí•˜ì‹  ì„¤ì¹˜ ì‹œì (í‰ì¼/ì£¼ë§) ë° ì„œë¹„ìŠ¤ ì¡°í•©ì— ë”°ë¼ ê³„ì‚°ë©ë‹ˆë‹¤. í”„ë¡œëª¨ì…˜ìœ¼ë¡œ ë©´ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </section>
        
        <section id="messageScriptSection" class="hidden mt-12">
            <h2 class="section-title">ğŸ“„ ê³ ê° ì•ˆë‚´ ë¬¸ì ìŠ¤í¬ë¦½íŠ¸ (ìƒë‹´ì› ì°¸ê³ ìš©)</h2>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-pink-600 mb-3">1. ì „ì‚° ë©”ëª¨</h3>
                <textarea id="memoScript" class="message-script-area" readonly></textarea>
                <div class="copy-button-container">
                    <button onclick="copyToClipboard('memoScript', 'copyFeedbackMemo')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackMemo" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-xl font-semibold text-pink-600">2. ìƒí’ˆ ì•ˆë‚´ ë¬¸ì</h3>
                    <button id="generateComparisonButton" class="btn-primary text-xs py-1 px-3">âš¡ 100M vs 500M ë¹„êµ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                </div>
                <textarea id="infoScript" class="message-script-area" readonly></textarea>
                 <div class="copy-button-container">
                    <button onclick="copyToClipboard('infoScript', 'copyFeedbackInfo')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackInfo" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-pink-600 mb-3">3. ê°€ì… ì™„ë£Œ ë¬¸ì</h3>
                <textarea id="completeScript" class="message-script-area" readonly></textarea>
                 <div class="copy-button-container">
                    <button onclick="copyToClipboard('completeScript', 'copyFeedbackComplete')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackComplete" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-pink-600 mb-3">4. ë¯¼ê°ì •ë³´ ì „ì†¡ìš© ë§í¬ (ê³ ê° ë°œì†¡ìš©)</h3>
                <textarea id="sensitiveInfoLinkScript" class="message-script-area" readonly></textarea>
                <div class="copy-button-container">
                    <button onclick="copyToClipboard('sensitiveInfoLinkScript', 'copyFeedbackSensitiveLink')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackSensitiveLink" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-pink-600 mb-3">5. U+ì•Œëœ°ëª¨ë°”ì¼ ì¸í„°ë„· ê²°í•© ìš”ê¸ˆì œ ì•ˆë‚´ (ê³ ê° ë°œì†¡ìš©)</h3>
                <textarea id="mvnoInfoScript" class="message-script-area" readonly></textarea>
                <div class="copy-button-container">
                    <button onclick="copyToClipboard('mvnoInfoScript', 'copyFeedbackMvnoInfo')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackMvnoInfo" class="copy-feedback"></span>
                </div>
            </div>

            <!-- Moved Expert Scripts Section -->
            <div id="expertScriptSection" class="mt-4">
                <h3 class="text-xl font-semibold text-pink-600 mb-3 border-t pt-4 mt-6">6. ì „ë¬¸ê°€ìš© ìƒë‹´ ìŠ¤í¬ë¦½íŠ¸</h3>
                <div class="result-card">
                    <h4 class="text-lg font-semibold text-pink-600 mb-3">1. 1ë…„ vs 3ë…„ ì•½ì • ìµœì¢… ë¹„ìš©(TCO) ë¹„êµ</h4>
                    <div class="flex space-x-4 mb-4">
                        <button id="generateTco100m" class="btn-primary text-sm flex-1">100Mbps ë¹„êµ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                        <button id="generateTco500m" class="btn-secondary text-sm flex-1">500Mbps ë¹„êµ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                    </div>
                    <textarea id="tcoScript" class="message-script-area" readonly></textarea>
                    <div class="copy-button-container">
                        <button onclick="copyToClipboard('tcoScript', 'copyFeedbackTco')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                        <span id="copyFeedbackTco" class="copy-feedback"></span>
                    </div>
                </div>
                 <div class="result-card">
                    <h4 class="text-lg font-semibold text-pink-600 mb-3">2. LGU+ ìœ„ì•½ê¸ˆ ì‚°ì • ë°©ì‹ ìƒì„¸ ë¶„ì„</h4>
                    <button id="generatePenaltyScript" class="btn-primary text-sm w-full mb-4">ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                    <textarea id="penaltyScript" class="message-script-area" readonly></textarea>
                    <div class="copy-button-container">
                        <button onclick="copyToClipboard('penaltyScript', 'copyFeedbackPenalty')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                        <span id="copyFeedbackPenalty" class="copy-feedback"></span>
                    </div>
                </div>
                 <div class="result-card">
                    <h4 class="text-lg font-semibold text-pink-600 mb-3">3. ìœ„ì•½ê¸ˆ ë©´ì œ ì¡°ê±´ ì´ì •ë¦¬</h4>
                    <button id="generateWaiverScript" class="btn-primary text-sm w-full mb-4">ì•ˆë‚´ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                    <textarea id="waiverScript" class="message-script-area" readonly></textarea>
                    <div class="copy-button-container">
                        <button onclick="copyToClipboard('waiverScript', 'copyFeedbackWaiver')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                        <span id="copyFeedbackWaiver" class="copy-feedback"></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW: Expert Scripts Section -->
    </main>

    <footer class="text-center p-6 mt-12 bg-pink-800 text-pink-200 text-sm">
        <p>ë³¸ ê³„ì‚°ê¸°ëŠ” LG U+ íŒë§¤ì  ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„°ì— ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>&copy; 2024 LG U+ ê²°í•© í• ì¸ ê³„ì‚°ê¸°. ëª¨ë“  ì •ë³´ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
    </footer>

    <script>
        // --- Data Section ---
        const lguMobilePlans = [
            { "plan_name": "ìš”ê¸ˆì œ ì„ íƒì—†ìŒ", "network_type": "None", "price": 0, "url": "#" },
            { "plan_name": "5G ì‹œê·¸ë‹ˆì²˜", "network_type": "5G", "price": 130000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205253" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ìŠˆí¼", "network_type": "5G", "price": 115000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205251" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ í”ŒëŸ¬ìŠ¤", "network_type": "5G", "price": 105000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205252" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ë ˆê·¤ëŸ¬", "network_type": "5G", "price": 95000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000433" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ì—ì„¼ì…œ", "network_type": "5G", "price": 85000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000409" },
            { "plan_name": "5G ìŠ¤íƒ ë‹¤ë“œ", "network_type": "5G", "price": 75000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000415" },
            { "plan_name": "5G ìŠ¤íƒ ë‹¤ë“œ ì—ì„¼ì…œ", "network_type": "5G", "price": 70000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000784" },
            { "plan_name": "ì¶”ê°€ ìš”ê¸ˆ ê±±ì • ì—†ëŠ” ë°ì´í„° 69", "network_type": "LTE", "price": 69000, "url": "https://www.lguplus.com/mobile/plan/mplan/lte-all/lte-unlimited/LPZ0000464" },
            { "plan_name": "5G ë°ì´í„° ìŠˆí¼", "network_type": "5G", "price": 68000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000781" },
            { "plan_name": "5G ë°ì´í„° í”ŒëŸ¬ìŠ¤", "network_type": "5G", "price": 66000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000782" },
            { "plan_name": "5G ë°ì´í„° ë ˆê·¤ëŸ¬", "network_type": "5G", "price": 63000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000783" },
            { "plan_name": "5G ì‹¬í”Œ+", "network_type": "5G", "price": 61000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0002860" },
            { "plan_name": "5G ë² ì´ì§+", "network_type": "5G", "price": 59000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ1001268" },
            { "plan_name": "5G ë¼ì´íŠ¸+", "network_type": "5G", "price": 55000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000437" },
            { "plan_name": "5G ë³µì§€ 55 (ë³µì§€í• ì¸ ëŒ€ìƒì)", "network_type": "5G", "price": 55000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G ìŠ¬ë¦¼+", "network_type": "5G", "price": 47000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000487" },
            { "plan_name": "5G ë¼ì´íŠ¸ ì²­ì†Œë…„ (ë§Œ 18ì„¸ ì´í•˜)", "network_type": "5G", "price": 45000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G í‚¤ì¦ˆ 45 (ë§Œ 12ì„¸ ì´í•˜)", "network_type": "5G", "price": 45000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G í‚¤ì¦ˆ 39 (ë§Œ 12ì„¸ ì´í•˜)", "network_type": "5G", "price": 39000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G ë¯¸ë‹ˆ", "network_type": "5G", "price": 37000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ1000325" },
            { "plan_name": "LTE ë°ì´í„° 33", "network_type": "LTE", "price": 33000, "url": "https://www.lguplus.com/mobile/plan/mplan/lte-all/" }
        ];
        
        const lguData = {
            "company": "LG U+",
            "internet_plans": {
                "standalone": {
                    "100M": { "name": "ì¸í„°ë„·(ë‹¨ë…) 100M", "price": 22000, "speed_mbps": 100, "type": "100M", "speed_tier": "100M" },
                    "500M": { "name": "ì¸í„°ë„·(ë‹¨ë…) 500M", "price": 33000, "speed_mbps": 500, "type": "500M", "speed_tier": "500M" },
                    "1G": { "name": "ì¸í„°ë„·(ë‹¨ë…) 1GB", "price": 38500, "speed_mbps": 1000, "type": "1G", "speed_tier": "1G" },
                    "500M_OTT": { "name": "500M+OTT 6ì¢… 3ë…„ ë¬´ë£Œ (ë‹¨ë…)", "price": 33000, "speed_mbps": 500, "type": "500M_OTT", "isOttPlan": true, "speed_tier": "500M" },
                    "1G_OTT": { "name": "1G+OTT 6ì¢… 3ë…„ ë¬´ë£Œ (ë‹¨ë…)", "price": 38500, "speed_mbps": 1000, "type": "1G_OTT", "isOttPlan": true, "speed_tier": "1G" }
                },
                "with_tv_base": {
                    "100M": { "name": "ì¸í„°ë„· 100M (TV ê²°í•© ì‹œ)", "price": 22000, "speed_mbps": 100, "type": "100M", "speed_tier": "100M" },
                    "500M": { "name": "ì¸í„°ë„· 500M (TV ê²°í•© ì‹œ)", "price": 27500, "speed_mbps": 500, "type": "500M", "speed_tier": "500M" },
                    "1G": { "name": "ì¸í„°ë„· 1GB (TV ê²°í•© ì‹œ)", "price": 33000, "speed_mbps": 1000, "type": "1G", "speed_tier": "1G" },
                    "500M_OTT": { "name": "500M+OTT 6ì¢… 3ë…„ ë¬´ë£Œ", "price": 27500, "speed_mbps": 500, "type": "500M_OTT", "isOttPlan": true, "speed_tier": "500M" },
                    "1G_OTT": { "name": "1G+OTT 6ì¢… 3ë…„ ë¬´ë£Œ", "price": 33000, "speed_mbps": 1000, "type": "1G_OTT", "isOttPlan": true, "speed_tier": "1G" }
                }
            },
            "tv_plans": {
                "basic_uhd4": { "name": "TVë² ì´ì§ + UHD4", "channels_info": "211ì±„ë„", "price": 16500, "category": "ë² ì´ì§" },
                "premium_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ + UHD4", "channels_info": "254ì±„ë„", "price": 20900, "category": "í”„ë¦¬ë¯¸ì—„" },
                "premium_lite_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë¼ì´íŠ¸ + UHD4", "channels_info": "259ì±„ë„", "price": 23100, "category": "í”„ë¦¬ë¯¸ì—„ ë¼ì´íŠ¸" },
                "premium_disney_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë””ì¦ˆë‹ˆ + UHD4", "price": 29000, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë””ì¦ˆë‹ˆ" },
                "premium_netflix_hd_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ HD + UHD4", "price": 32200, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ HD" },
                "premium_netflix_uhd_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ UHD + UHD4", "price": 35700, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ UHD" }
            },
            "phone_plans": {
                "voip_own_device": { "name": "ì¸í„°ë„· ì „í™”(070) - ë‹¨ë§ê¸° ë³´ìœ ", "price": 3300 },
                "voip_rental_device": { "name": "ì¸í„°ë„· ì „í™” (070) - ë‹¨ë§ê¸° ì„ëŒ€", "price": 5562 }
            },
            "wifi_router": {
                "standard": { "name": "ê³µìœ ê¸°", "price": 0, "notes": "ì¼ë°˜ì ìœ¼ë¡œ ì¸í„°ë„· ìš”ê¸ˆì œì— í¬í•¨" }
            },
            "additional_tv_options": {
                "basic_uhd4_add": { "name": "TV ì¶”ê°€ ë² ì´ì§ + UHD4", "channels_info": "211ì±„ë„", "price": 11550 },
                "basic_advanced_stb_for_100m_internet_add": { "name": "TV ì¶”ê°€ ë² ì´ì§(ê³ ê¸‰í˜•) / 100mb ì¸í„°ë„· ì‹œ", "price": 10450, "condition": "100mb ì¸í„°ë„· ì´ìš© ì‹œ" },
                "premium_uhd4_add": { "name": "TV ì¶”ê°€ í”„ë¦¬ë¯¸ì—„(UHD4)", "price": 13750 }
            },
            "bundle_discounts_on_internet": {
                "with_tv": {
                    "100M": { "cham_family": { "discount": 5500 }, "internet_family_all_together": { "discount": 5500 } },
                    "500M": { "cham_family": { "discount": 9900 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } },
                    "1G": { "cham_family": { "discount": 13200 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } }
                },
                "standalone_internet": {
                    "100M": { "cham_family": { "discount": 5500 }, "internet_family_all_together": { "discount": 5500 } },
                    "500M": { "cham_family": { "discount": 9900 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } },
                    "1G": { "cham_family": { "discount": 13200 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } }
                }
            },
            "mobile_discounts": {
                "cham_family": [
                    { "lines": [2], "tiers": { "under_47k": 2200, "under_69k": 3300, "over_69k": 5500 } },
                    { "lines": [3], "tiers": { "under_47k": 3300, "under_69k": 5500, "over_69k": 7700 } },
                    { "lines": [4, 5, 6, 7, 8, 9, 10], "tiers": { "under_47k": 4400, "under_69k": 7700, "over_69k": 11000 } }
                ],
                "together_bundle": [
                    { "lines": [2], "discount_per_line": 10000 },
                    { "lines": [3], "discount_per_line": 14000 },
                    { "lines": [4, 5], "discount_per_line": 20000 }
                ]
            }
        };
        const giftTableLGU = { "100Më‹¨ë…": { cash: 200000 }, "500Më‹¨ë…": { cash: 230000 }, "1Gë‹¨ë…": { cash: 230000 }, "100Më²ˆë“¤": { cash: 400000 }, "500Më²ˆë“¤": { cash: 470000 }, "1Gë²ˆë“¤": { cash: 470000 } };
        const commissionDataLG = {
          "internet_tv": {
            "description": "LG U+ ì¸í„°ë„· + TV ê²°í•© ìƒí’ˆ ì •ì±… (OTT 6ì¢… 3ë…„ ë¬´ë£Œ í˜œíƒ ì œê³µ)",
            "general_notes": [
              "1ê¸°ê°€ ì¸í„°ë„· ì ‘ìˆ˜ ì‹œ íŒë§¤ì ìˆ˜ìˆ˜ë£Œì— 10,000ì› ì¶”ê°€"
            ],
            "commission_rules": [
              { "commission": 80000, "support_money_min": 350000, "support_money_max": 400000, "plan_tier": "premium", "plan_names": "U+tv í”„ë¦¬ë¯¸ì—„", "notes": [] },
              { "commission": 70000, "support_money_min": 350000, "support_money_max": 400000, "plan_tier": "basic", "plan_names": "U+tv ë² ì´ì§", "notes": [] },
              { "commission": 70000, "support_money_min": 410000, "support_money_max": 440000, "plan_tier": "premium", "plan_names": "U+tv í”„ë¦¬ë¯¸ì—„", "notes": ["ì§€ì›ê¸ˆ 430,000ì›ê¹Œì§€ëŠ” OTT í˜œíƒ ì œê³µ ê°€ëŠ¥", "ì§€ì›ê¸ˆ 440,000ì›ë¶€í„°ëŠ” OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] },
              { "commission": 60000, "support_money_min": 410000, "support_money_max": 440000, "plan_tier": "basic", "plan_names": "U+tv ë² ì´ì§", "notes": ["ì§€ì›ê¸ˆ 430,000ì›ê¹Œì§€ëŠ” OTT í˜œíƒ ì œê³µ ê°€ëŠ¥", "ì§€ì›ê¸ˆ 440,000ì›ë¶€í„°ëŠ” OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] },
              { "commission": 60000, "support_money_min": 450000, "support_money_max": 500000, "plan_tier": "premium", "plan_names": "U+tv í”„ë¦¬ë¯¸ì—„", "notes": ["ê¸°ë³¸ì ìœ¼ë¡œ OTT í˜œíƒ ë¯¸í¬í•¨", "OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] },
              { "commission": 30000, "support_money_min": 450000, "support_money_max": 500000, "plan_tier": "basic", "plan_names": "U+tv ë² ì´ì§", "notes": ["ê¸°ë³¸ì ìœ¼ë¡œ OTT í˜œíƒ ë¯¸í¬í•¨", "OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] },
              { "commission": 30000, "support_money_min": 510000, "support_money_max": 550000, "plan_tier": "premium", "plan_names": "U+tv í”„ë¦¬ë¯¸ì—„", "notes": ["ê¸°ë³¸ì ìœ¼ë¡œ OTT í˜œíƒ ë¯¸í¬í•¨", "OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] },
              { "commission": 20000, "support_money_min": 510000, "support_money_max": 550000, "plan_tier": "basic", "plan_names": "U+tv ë² ì´ì§", "notes": ["ê¸°ë³¸ì ìœ¼ë¡œ OTT í˜œíƒ ë¯¸í¬í•¨", "OTT í¬í•¨ ì‹œ ìˆ˜ìˆ˜ë£Œ 10,000ì› ì°¨ê°"] }
            ]
          },
          "internet_only": {
            "description": "LG U+ ì¸í„°ë„· ë‹¨ë… ìƒí’ˆ ì •ì±… (500ë©”ê°€ ê¸°ì¤€, OTT 6ì¢… 3ë…„ ë¬´ë£Œ í˜œíƒ ì œê³µ)",
            "general_notes": [],
            "commission_rules": [
              { "commission": 60000, "support_money": 170000, "payout_method": "ì „ì•¡ í˜„ê¸ˆ" },
              { "commission": 30000, "support_money_min": 200000, "support_money_max": 250000, "payout_method": "ì „ì•¡ í˜„ê¸ˆ" }
            ]
          }
        };

        const mvnoBundleConfigFallback = { internetDiscount: { "100M": 5500, "500M": 9900, "1G": 13200 } };
        const installationFeeRules = {
            "weekday": [
              { "service_combination": "ì¸í„°ë„·", "fee": 36300 },
              { "service_combination": "ì¸í„°ë„· + ì¼ë°˜ì „í™”", "fee": 36300 },
              { "service_combination": "ì¸í„°ë„· + ì¸í„°ë„·ì „í™”", "fee": 36300 },
              { "service_combination": "ì¸í„°ë„· + TV", "fee": 56100 },
              { "service_combination": "ì¸í„°ë„· + TV + ì¼ë°˜/070ì „í™”", "fee": 56100 },
              { "service_combination": "ì¸í„°ë„· + TV + TVì¶”ê°€", "fee": 78100 }
            ],
            "weekend": [
              { "service_combination": "ì¸í„°ë„·", "fee": 45375 },
              { "service_combination": "ì¸í„°ë„· + ì¼ë°˜ì „í™”", "fee": 45375 },
              { "service_combination": "ì¸í„°ë„· + ì¸í„°ë„·ì „í™”", "fee": 45375 },
              { "service_combination": "ì¸í„°ë„· + TV", "fee": 70125 },
              { "service_combination": "ì¸í„°ë„· + TV + ì¼ë°˜/070ì „í™”", "fee": 70125 },
              { "service_combination": "ì¸í„°ë„· + TV + TVì¶”ê°€", "fee": 97625 }
            ]
        };
        const affiliateCardData = {
            "woori": {
                "cardName": "ìš°ë¦¬ì¹´ë“œ", "phone": "1800-1111",
                "tiers": [
                    { "spending": 400000, "label": "40ë§Œì› ì´ìƒ", "discount": 25000 },
                    { "spending": 800000, "label": "80ë§Œì› ì´ìƒ", "discount": 26000 }
                ]
            },
            "shinhan": {
                "cardName": "ì‹ í•œì¹´ë“œ", "phone": "1544-7000",
                "tiers": [
                    { "spending": 400000, "label": "40ë§Œì› ì´ìƒ", "discount": 21000 },
                    { "spending": 800000, "label": "80ë§Œì› ì´ìƒ", "discount": 23000 }
                ]
            },
            "lotte": {
                "cardName": "ë¡¯ë°ì¹´ë“œ", "phone": "1588-8100",
                "tiers": [
                    { "spending": 300000, "label": "30ë§Œì› ì´ìƒ", "discount": 18000 },
                    { "spending": 700000, "label": "70ë§Œì› ì´ìƒ", "discount": 19000 }
                ]
            },
            "nh": {
                "cardName": "ë†í˜‘ì¹´ë“œ", "phone": "1644-4000",
                "tiers": [
                    { "spending": 300000, "label": "30ë§Œì› ì´ìƒ", "discount": 18000 },
                    { "spending": 700000, "label": "70ë§Œì› ì´ìƒ", "discount": 24000 }
                ]
            },
            "samsung": {
                "cardName": "ì‚¼ì„±ì¹´ë“œ", "phone": "1588-8700",
                "tiers": [
                    { "spending": 300000, "label": "30ë§Œì› ì´ìƒ", "discount": 20000 },
                    { "spending": 700000, "label": "70ë§Œì› ì´ìƒ", "discount": 21000 }
                ]
            },
            "hyundai": {
                "cardName": "í˜„ëŒ€ì¹´ë“œ", "phone": "1577-6000",
                "tiers": [
                    { "spending": 500000, "label": "50ë§Œì› ì´ìƒ", "discount": 30000 },
                    { "spending": 1000000, "label": "100ë§Œì› ì´ìƒ", "discount": 35000 }
                ]
            }
        };

        const tcoData = {
            "100M": { "lgu": { "name": "LGU+", "oneYearFee": 34100, "oneYearTCO13": 443300, "oneYearTCO18": 613800, "threeYearFee": 16500, "threeYearGift": 200000, "threeYearTCO13": 189552, "threeYearTCO18": 323077 } },
            "500M": { "lgu": { "name": "LGU+", "oneYearFee": 46200, "oneYearTCO13": 600600, "oneYearTCO18": 831600, "threeYearFee": 23100, "threeYearGift": 230000, "threeYearTCO13": 358000, "threeYearTCO18": 542800 } }
        };

        const penaltyAnalysisData = {
            text: `LGU+ ìœ„ì•½ê¸ˆ ìƒì„¸ ë¶„ì„\n\nâ–  LGU+ ìœ„ì•½ê¸ˆ ì‚°ì • ë°©ì‹ (ì‹ ê·œ ì²´ê³„)\nLGìœ í”ŒëŸ¬ìŠ¤ëŠ” KTì™€ ë‹¬ë¦¬ êµ¬ê°„ë³„ë¡œ ì •í•´ì§„ 'í• ì¸ë°˜í™˜ìœ¨'ì„ ì ìš©í•˜ì—¬ ì›”ë³„ ìœ„ì•½ê¸ˆì„ ê³„ì‚°í•œ ë’¤, ì´ë¥¼ ëª¨ë‘ í•©ì‚°í•˜ëŠ” ëˆ„ì  ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\nâ–  í• ì¸ë°˜í™˜ê¸ˆ ê³µì‹\nâˆ‘ (ì›”í• ì¸ì•¡ Ã— í•´ë‹¹êµ¬ê°„ê°œì›”ìˆ˜ Ã— êµ¬ê°„ë³„í• ì¸ë°˜í™˜ìœ¨)\n\nâ–  êµ¬ê°„ë³„ í• ì¸ë°˜í™˜ìœ¨ (3ë…„ ì•½ì •, TVí”„ë¦¬ë¯¸ì—„+500M ê¸°ì¤€)\n- ê¸°ë³¸ ì›” í• ì¸ì•¡: â‚©20,900\n- 1~9ê°œì›”: 85%\n- 10~12ê°œì›”: 80%\n- 13~18ê°œì›”: 30%\n- 19~21ê°œì›”: 25%\n- 22~24ê°œì›”: 0%\n\nâ–  ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë¸ë§ (ì‹ ê·œ ì²´ê³„ ê³µì‹ ì ìš©)\n1) 13ê°œì›” ì‚¬ìš© í›„ í•´ì§€:\n- 1~9ê°œì›”ë¶„: â‚©20,900 Ã— 9ê°œì›” Ã— 0.85 = â‚©159,885\n- 10~12ê°œì›”ë¶„: â‚©20,900 Ã— 3ê°œì›” Ã— 0.80 = â‚©50,160\n- 13ê°œì›”ì°¨ë¶„: â‚©20,900 Ã— 1ê°œì›” Ã— 0.30 = â‚©6,270\n- ìµœì¢… ìœ„ì•½ê¸ˆ: â‚©216,315\n\n2) 18ê°œì›” ì‚¬ìš© í›„ í•´ì§€:\n- 1~12ê°œì›”ë¶„ í•©ê³„: â‚©210,045\n- 13~18ê°œì›”ë¶„: â‚©20,900 Ã— 6ê°œì›” Ã— 0.30 = â‚©37,620\n- ìµœì¢… ìœ„ì•½ê¸ˆ: â‚©247,665\n\n3) 24ê°œì›” ì‚¬ìš© í›„ í•´ì§€:\n- 1~18ê°œì›”ë¶„ í•©ê³„: â‚©247,665\n- 19~21ê°œì›”ë¶„: â‚©20,900 Ã— 3ê°œì›” Ã— 0.25 = â‚©15,675\n- 22~24ê°œì›”ë¶„: â‚©20,900 Ã— 3ê°œì›” Ã— 0.00 = â‚©0\n- ìµœì¢… ìœ„ì•½ê¸ˆ: â‚©263,340`
        };

        const waiverConditionsData = {
            text: `[ìƒì„¸ ì•ˆë‚´] ìœ„ì•½ê¸ˆ ë©´ì œ ì¡°ê±´ ì´ì •ë¦¬\n\nì•ˆë…•í•˜ì„¸ìš” ê³ ê°ë‹˜, 3ë…„ ì•½ì • ë¶€ë‹´ì„ ëœì–´ë“œë¦¬ê¸° ìœ„í•´ ì•½ì • ê¸°ê°„ ì¤‘ í”¼ì¹˜ ëª»í•  ì‚¬ì •ìœ¼ë¡œ í•´ì§€í•˜ì‹œë”ë¼ë„ ìœ„ì•½ê¸ˆ(í• ì¸ë°˜í™˜ê¸ˆ)ì´ ë©´ì œë˜ëŠ” ê³µì‹ì ì¸ ê²½ìš°ë¥¼ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤.\n\nâ–  ìœ„ì•½ê¸ˆ ë©´ì œ ê°€ëŠ¥ ì£¼ìš” ì‚¬ìœ \n1. ì„¤ì¹˜ ì¥ì†Œì˜ ì„œë¹„ìŠ¤ ë¶ˆê°€\n   - ì´ì‚¬ ê°„ ê³³ì´ U+ ì¸í„°ë„· ì„œë¹„ìŠ¤ê°€ ë¶ˆê°€ëŠ¥í•œ ì§€ì—­ì¸ ê²½ìš° (ì¦ë¹™ì„œë¥˜ í•„ìš”)\n2. ê°€ì…ì ì‚¬ë§\n   - ëª…ì˜ì ì‚¬ë§ ì‹œ (ì¦ë¹™ì„œë¥˜ í•„ìš”)\n3. êµ° ì…ëŒ€\n   - ëª…ì˜ìê°€ í˜„ì—­ìœ¼ë¡œ ì…ëŒ€í•˜ëŠ” ê²½ìš° (ì…ì˜í†µì§€ì„œ ë“± ì¦ë¹™ì„œë¥˜ í•„ìš”)\n\nâ–  ì°¸ê³ ì‚¬í•­\n- ìœ„ ì¡°ê±´ì— í•´ë‹¹í•˜ë”ë¼ë„ ì¦ë¹™ì„œë¥˜ ì œì¶œì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n- ìì„¸í•œ ê¸°ì¤€ê³¼ í•„ìš” ì„œë¥˜ëŠ” ìƒí™©ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í•´ì§€ ì‹œì ì— U+ ê³ ê°ì„¼í„°(101ë²ˆ)ë¥¼ í†µí•´ ë°˜ë“œì‹œ ìµœì¢… í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\nì´ì²˜ëŸ¼ ë¶€ë“ì´í•œ ê²½ìš°ì—ëŠ” 'ì•ˆì „ì¥ì¹˜'ê°€ ë§ˆë ¨ë˜ì–´ ìˆìœ¼ë‹ˆ, ë„ˆë¬´ ê±±ì •í•˜ì§€ ì•Šìœ¼ì…”ë„ ê´œì°®ìŠµë‹ˆë‹¤.`
        };

        // --- DOM Element References ---
        const vatToggle = document.getElementById('vatToggle');
        const internetTypeRadios = document.querySelectorAll('input[name="internetType"]');
        const internetPlanEl = document.getElementById('internetPlan');
        const tvPlanEl = document.getElementById('tvPlan');
        const additionalTvPlanEl = document.getElementById('additionalTvPlan');
        const phonePlanEl = document.getElementById('phonePlan');
        const mobileLinesCountEl = document.getElementById('mobileLinesCount');
        const mobileLinesContainerEl = document.getElementById('mobileLinesContainer');
        const discountTypeRadios = document.querySelectorAll('input[name="discountType"]');
        const calculateButton = document.getElementById('calculateButton');
        const resetButton = document.getElementById('resetButton');
        const generateComparisonButton = document.getElementById('generateComparisonButton');
        const affiliateCardEl = document.getElementById('affiliateCard');
        const cardSpendingTierGroupEl = document.getElementById('cardSpendingTierGroup');
        const cardSpendingTierEl = document.getElementById('cardSpendingTier');
        const commissionPolicyEl = document.getElementById('commissionPolicy');
        const installationFeeSelfPayEl = document.getElementById('installationFeeSelfPay');

        // Discount Details Toggles
        const chamFamilyDetailsToggleEl = document.getElementById('chamFamilyDetailsToggle');
        const chamFamilyDetailsContainerEl = document.getElementById('chamFamilyDetailsContainer');
        const detailCfInternetDiscountEl = document.getElementById('detailCfInternetDiscount');
        const detailCfMobileDiscountEl = document.getElementById('detailCfMobileDiscount');
        const togetherDetailsToggleEl = document.getElementById('togetherDetailsToggle');
        const togetherDetailsContainerEl = document.getElementById('togetherDetailsContainer');
        const detailTgInternetDiscountEl = document.getElementById('detailTgInternetDiscount');
        const detailTgMobileDiscountEl = document.getElementById('detailTgMobileDiscount');
        const internetFamilyDetailsToggleEl = document.getElementById('internetFamilyDetailsToggle');
        const internetFamilyDetailsContainerEl = document.getElementById('internetFamilyDetailsContainer');
        const detailIfInternetDiscountEl = document.getElementById('detailIfInternetDiscount');
        const mvnoLGUDetailsToggleEl = document.getElementById('mvnoLGUDetailsToggle');
        const mvnoLGUDetailsContainerEl = document.getElementById('mvnoLGUDetailsContainer');
        const detailMvnoLGUInternetDiscountEl = document.getElementById('detailMvnoLGUInternetDiscount');
        
        // Result Section Elements
        const resultSection = document.getElementById('resultSection');
        
        // New Summary Card Elements
        const preDiscountWiredFeeEl = document.getElementById('preDiscountWiredFeeEl');
        const finalWiredFeeEl = document.getElementById('finalWiredFeeEl');
        const cardDiscountEl = document.getElementById('cardDiscountEl');
        const giftAmountEl = document.getElementById('giftAmountEl');
        const mobileDiscountEl = document.getElementById('mobileDiscountEl');
        const discountReasonEl = document.getElementById('discountReason');
        
        
        // Details Section Elements
        const detailsToggleButton = document.getElementById('detailsToggleButton');
        const detailsContainer = document.getElementById('detailsContainer');
        const selectedInternetEl = document.getElementById('selectedInternet');
        const selectedTvEl = document.getElementById('selectedTv');
        const selectedAdditionalTvEl = document.getElementById('selectedAdditionalTv');
        const selectedPhoneEl = document.getElementById('selectedPhone');
        const selectedMobileCountEl = document.getElementById('selectedMobileCount');
        const selectedDiscountTypeEl = document.getElementById('selectedDiscountType');
        const totalBaseWiredCostEl = document.getElementById('totalBaseWiredCost');
        const totalInternetDiscountAmountEl = document.getElementById('totalInternetDiscountAmount');
        const totalCardDiscountAmountEl = document.getElementById('totalCardDiscountAmount');
        const finalMonthlyCostEl = document.getElementById('finalMonthlyCost');
        const installationCostResultEl = document.getElementById('installationCostResult');
        const giftCashEl = document.getElementById('giftCash');
        const mobileDiscountDetailsContainerEl = document.getElementById('mobileDiscountDetailsContainer');
        const mobileDiscountResultListEl = document.getElementById('mobileDiscountResultList');
        
        // Message Script Elements
        const messageScriptSectionEl = document.getElementById('messageScriptSection');
        const memoScriptEl = document.getElementById('memoScript');
        const infoScriptEl = document.getElementById('infoScript');
        const completeScriptEl = document.getElementById('completeScript');
        const sensitiveInfoLinkScriptEl = document.getElementById('sensitiveInfoLinkScript');
        const mvnoInfoScriptEl = document.getElementById('mvnoInfoScript');

        // Expert Script Elements
        const expertScriptSectionEl = document.getElementById('expertScriptSection');
        const generateTco100mBtn = document.getElementById('generateTco100m');
        const generateTco500mBtn = document.getElementById('generateTco500m');
        const tcoScriptEl = document.getElementById('tcoScript');
        const generatePenaltyBtn = document.getElementById('generatePenaltyScript');
        const penaltyScriptEl = document.getElementById('penaltyScript');
        const generateWaiverBtn = document.getElementById('generateWaiverScript');
        const waiverScriptEl = document.getElementById('waiverScript');

        const allDetailSectionsLGU = [
            { radioValue: 'cham_family', toggleEl: chamFamilyDetailsToggleEl, containerEl: chamFamilyDetailsContainerEl, updateFn: updateChamFamilyDetails },
            { radioValue: 'together_bundle', toggleEl: togetherDetailsToggleEl, containerEl: togetherDetailsContainerEl, updateFn: updateTogetherDetails },
            { radioValue: 'internet_family_all_together', toggleEl: internetFamilyDetailsToggleEl, containerEl: internetFamilyDetailsContainerEl, updateFn: updateInternetFamilyDetails },
            { radioValue: 'mvno_bundle', toggleEl: mvnoLGUDetailsToggleEl, containerEl: mvnoLGUDetailsContainerEl, updateFn: updateMvnoLGUDetails }
        ];
        
        // --- Global State ---
        let isVatIncluded = false;

        // --- Functions ---
        function adjustForVat(price) {
            return isVatIncluded ? price : Math.round(price / 1.1);
        }

        function formatPrice(price) {
            return adjustForVat(price).toLocaleString();
        }

        function resetCalculator() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            resultSection.classList.add('hidden');
            messageScriptSectionEl.classList.add('hidden');
            detailsContainer.classList.add('hidden');
            detailsToggleButton.textContent = 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼';
        
            document.querySelector('input[name="internetType"][value="bundle"]').checked = true;
            document.querySelector('input[name="discountType"][value="none"]').checked = true;
            
            // Set new defaults
            internetPlanEl.value = '500M_OTT';
            tvPlanEl.value = 'premium_uhd4';
            setDefaultAffiliateCard();

            vatToggle.checked = false;
            isVatIncluded = false;

            installationFeeSelfPayEl.checked = false;

            document.querySelectorAll('.toggle-switch input[type="checkbox"]:not(#vatToggle)').forEach(toggle => {
                toggle.checked = false;
            });

            allDetailSectionsLGU.forEach(section => {
                if(section.containerEl) section.containerEl.classList.add('hidden');
            });
            handleInternetTypeChange();
            updateMobileLineControls();
            updateAllDiscountDetails();
            populateCommissionPolicies();
        }
        
        function setDefaultAffiliateCard() {
            let bestCard = {
                key: 'none',
                tierIndex: -1,
                discount: -1
            };

            // Iterate through all available affiliate cards
            for (const cardKey in affiliateCardData) {
                const card = affiliateCardData[cardKey];

                // Find the index of the tier that requires exactly 300,000 KRW spending
                const tierIndex = card.tiers.findIndex(t => t.spending === 300000);

                // If a 300,000 KRW tier exists for this card
                if (tierIndex !== -1) {
                    const tier = card.tiers[tierIndex];

                    // Check if this card's discount is better than the best one found so far
                    if (tier.discount > bestCard.discount) {
                        // If it is, update our record of the best card
                        bestCard = {
                            key: cardKey,
                            tierIndex: tierIndex,
                            discount: tier.discount
                        };
                    }
                }
            }

            // Set the dropdowns to the best card and tier found
            if (bestCard.key !== 'none') {
                affiliateCardEl.value = bestCard.key;
                updateCardTiers(); // This populates the tiers for the selected card
                cardSpendingTierEl.value = bestCard.tierIndex; // This selects the correct tier
            } else {
                // If no card with a 300k tier was found, default to 'none'
                affiliateCardEl.value = 'none';
                updateCardTiers();
            }
        }

        function updateInternetPlanDisability() {
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            const option100M = internetPlanEl.querySelector('option[value="100M"]');
            if (option100M) {
                option100M.disabled = selectedDiscount === 'together_bundle';
            }
        }
        
        function getMobileDiscount(discountType, numLines, planInputs) {
            let totalBundleDiscount = 0;
            let totalSelectiveDiscount = 0;
        
            const bundleRules = lguData.mobile_discounts[discountType];
            const actualPlanInputs = planInputs.filter(p => p.price > 0);
            const actualNumLines = actualPlanInputs.length;

            if (actualNumLines >= 2 && bundleRules) {
                if (discountType === 'cham_family') {
                    const lineCountForRule = Math.min(actualNumLines, 10);
                    const rule = bundleRules.find(r => r.lines.includes(lineCountForRule)) || bundleRules[bundleRules.length - 1];
                    if (rule) {
                        actualPlanInputs.forEach(input => {
                            if (input.price >= 69000) totalBundleDiscount += rule.tiers.over_69k;
                            else if (input.price >= 47000) totalBundleDiscount += rule.tiers.under_69k;
                            else totalBundleDiscount += rule.tiers.under_47k;
                        });
                    }
                } else if (discountType === 'together_bundle') {
                    const lineCountForRule = Math.min(actualNumLines, 5);
                    const rule = bundleRules.find(r => r.lines.includes(lineCountForRule)) || bundleRules[bundleRules.length - 1];
                    if (rule) {
                        const eligibleLines = actualPlanInputs.filter(p => p.price >= 85000).length;
                        if (eligibleLines === actualNumLines) {
                            totalBundleDiscount = actualNumLines * rule.discount_per_line;
                        }
                    }
                }
            }
        
            planInputs.forEach(input => {
                if (input.selectiveDiscountChecked) {
                    totalSelectiveDiscount += Math.floor(input.price * 0.25);
                }
            });
        
            return { totalBundleDiscount, totalSelectiveDiscount, total: totalBundleDiscount + totalSelectiveDiscount };
        }
        
        function updateMobileLinesInputsLGU() {
            const count = parseInt(mobileLinesCountEl.value) || 0;
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            mobileLinesContainerEl.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const div = document.createElement('div');
                div.className = 'mobile-line-item';
                const label = document.createElement('label');
                label.htmlFor = `mobilePlan${i}`;
                label.className = 'block text-sm font-medium text-slate-600 mb-1';
                label.textContent = `íšŒì„  ${i + 1} ìš”ê¸ˆì œ ì„ íƒ`;
                const select = document.createElement('select');
                select.id = `mobilePlan${i}`;
                select.className = 'select-field mobile-plan-selector';
                lguMobilePlans.forEach(plan => {
                    const option = document.createElement('option');
                    option.value = plan.price;
                    option.textContent = `${plan.plan_name} (${plan.price === 0 ? 'ì„ íƒì•ˆí•¨' : formatPrice(plan.price) + 'ì›'})`;
                    option.dataset.planName = plan.plan_name;
                    option.dataset.url = plan.url;
                    if (selectedDiscount === 'together_bundle' && plan.price < 85000 && plan.price !== 0) {
                        option.disabled = true;
                    }
                    select.appendChild(option);
                });

                if (selectedDiscount === 'cham_family' || selectedDiscount === 'together_bundle' || selectedDiscount === 'mvno_bundle') {
                    select.value = "0"; // Default to "ìš”ê¸ˆì œ ì„ íƒì—†ìŒ"
                }

                const checkboxLabel = document.createElement('label');
                checkboxLabel.className = 'flex items-center mt-2 text-sm text-slate-600';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `selectiveDiscount${i}`;
                checkbox.className = 'radio-input h-4 w-4 selective-discount-cb';
                checkboxLabel.appendChild(checkbox);
                checkboxLabel.append(' ì„ íƒì•½ì • 25% í• ì¸');
                div.appendChild(label);
                div.appendChild(select);
                div.appendChild(checkboxLabel);
                mobileLinesContainerEl.appendChild(div);
                select.addEventListener('change', updateAllDiscountDetails);
                checkbox.addEventListener('change', updateAllDiscountDetails);
            }
            updateAllDiscountDetails();
        }
        
        function updateAllDiscountDetails() {
            updateChamFamilyDetails();
            updateTogetherDetails();
            updateInternetFamilyDetails();
            updateMvnoLGUDetails();
        }
        
        function updateChamFamilyDetails() {
            const internetKey = internetPlanEl.value;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            let internetDiscount = 0;
            if (internetKey !== 'none' && numMobileLines > 0) {
                internetDiscount = getDiscountFromBundle(internetKey, "cham_family", isBundle, numMobileLines);
            }
            detailCfInternetDiscountEl.textContent = formatPrice(internetDiscount);
            const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                price: parseInt(item.querySelector('.mobile-plan-selector').value),
                selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
            }));
            const mobileDiscount = getMobileDiscount('cham_family', numMobileLines, planInputs);
            detailCfMobileDiscountEl.textContent = formatPrice(mobileDiscount.total);
        }
        
        function updateTogetherDetails() {
            const internetKey = internetPlanEl.value;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            let internetDiscount = 0;
            if (internetKey !== 'none') {
                internetDiscount = getDiscountFromBundle(internetKey, "together_bundle", isBundle, numMobileLines);
            }
            detailTgInternetDiscountEl.textContent = formatPrice(internetDiscount);
            const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                price: parseInt(item.querySelector('.mobile-plan-selector').value),
                selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
            }));
            const mobileDiscount = getMobileDiscount('together_bundle', numMobileLines, planInputs);
            detailTgMobileDiscountEl.textContent = formatPrice(mobileDiscount.total);
        }
        
        function updateInternetFamilyDetails() {
            const internetKey = internetPlanEl.value;
            let internetDiscount = 0;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            if (internetKey !== 'none') {
                 internetDiscount = getDiscountFromBundle(internetKey, "internet_family_all_together", isBundle, parseInt(mobileLinesCountEl.value) || 0);
            }
            detailIfInternetDiscountEl.textContent = formatPrice(internetDiscount);
        }
        
        function updateMvnoLGUDetails() {
            const internetKey = internetPlanEl.value;
            let internetDiscount = 0;
            if (internetKey !== 'none' && (parseInt(mobileLinesCountEl.value) || 0) > 0) {
                const currentInternetDetails = getInternetPlanInfo(internetKey, document.querySelector('input[name="internetType"]:checked').value === 'bundle');
                const internetType = currentInternetDetails.type;
                if (internetType && mvnoBundleConfigFallback.internetDiscount[internetType]) {
                    internetDiscount = mvnoBundleConfigFallback.internetDiscount[internetType];
                }
            }
            detailMvnoLGUInternetDiscountEl.textContent = formatPrice(internetDiscount);
        }
        
        function populateSelectWithOptionsGeneric(selectElement, dataObject, defaultKey = "none", nameKey = "name", priceKey = "price") {
            const currentValue = selectElement.value;
            selectElement.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            for (const key in dataObject) {
                const item = dataObject[key];
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${item[nameKey]} (ì›” ${formatPrice(item[priceKey])}ì›)`;
                option.dataset.price = item[priceKey];
                if (item.speed_mbps) option.dataset.speed = item.speed_mbps;
                if (item.type) option.dataset.type = item.type;
                if (item.channels_info) option.dataset.channels = item.channels_info;
                if (item.category) option.dataset.category = item.category;
                selectElement.appendChild(option);
            }
            if (selectElement.querySelector(`option[value="${currentValue}"]`)) {
                selectElement.value = currentValue;
            } else if (defaultKey !== "none" && dataObject[defaultKey]) {
                selectElement.value = defaultKey;
            } else if (defaultKey === "none" && selectElement.options.length > 0) {
                selectElement.value = "none";
            }
        }
        
        function populateInternetPlans(isBundle) {
            internetPlanEl.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            const plansToShow = isBundle ? lguData.internet_plans.with_tv_base : lguData.internet_plans.standalone;
            const notesEl = document.getElementById('internetNotes');
            for (const key in plansToShow) {
                const item = plansToShow[key];
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${item.name} (ì›” ${formatPrice(item.price)}ì›)`;
                option.dataset.price = item.price;
                option.dataset.speed = item.speed_mbps;
                option.dataset.type = item.type;
                option.dataset.isOttPlan = item.isOttPlan || false;
                internetPlanEl.appendChild(option);
            }
            internetPlanEl.value = "500M_OTT";
            if (notesEl) {
                notesEl.textContent = isBundle ? "ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨. TV ê²°í•© ì‹œ ê¸°ë³¸ í• ì¸ëœ ìš”ê¸ˆì…ë‹ˆë‹¤." : "ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨.";
            }
            updateInternetPlanDisability();
            handleInternetPlanChange();
        }

        function handleInternetPlanChange() {
            const selectedOption = internetPlanEl.options[internetPlanEl.selectedIndex];
            const isOtt = selectedOption.dataset.isOttPlan === 'true';
            commissionPolicyEl.disabled = !isOtt;
            if (!isOtt) {
                commissionPolicyEl.value = 'none';
            }
        }
        
        function handleInternetTypeChange() {
            const selectedType = document.querySelector('input[name="internetType"]:checked').value;
            const isBundle = selectedType === 'bundle';
            populateInternetPlans(isBundle);
            tvPlanEl.disabled = !isBundle;
            additionalTvPlanEl.disabled = !isBundle;
            if (!isBundle) {
                tvPlanEl.value = 'none';
                additionalTvPlanEl.value = 'none';
            } else {
                if (tvPlanEl.value === 'none') {
                     tvPlanEl.value = 'premium_uhd4';
                }
            }
            handleTvPlanChange();
        }
        
        function handleTvPlanChange() {
            const isFirstTvSelected = tvPlanEl.value !== 'none';
            const isBundleType = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            additionalTvPlanEl.disabled = !isFirstTvSelected || !isBundleType;
            if (!isFirstTvSelected || !isBundleType) {
                additionalTvPlanEl.value = 'none';
            }
        }
        
        function updateMobileLineControls() {
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            let mobileCount = 0;
            let isMobileDisabled = true;
            switch (selectedDiscount) {
                case 'none': mobileCount = 0; isMobileDisabled = true; break;
                case 'cham_family': mobileCount = 1; isMobileDisabled = false; break;
                case 'together_bundle': mobileCount = 1; isMobileDisabled = false; break;
                case 'internet_family_all_together': mobileCount = 0; isMobileDisabled = true; break;
                case 'mvno_bundle': mobileCount = 1; isMobileDisabled = false; break;
                default: mobileCount = 0; isMobileDisabled = true;
            }
            mobileLinesCountEl.value = mobileCount;
            mobileLinesCountEl.disabled = isMobileDisabled;
            updateMobileLinesInputsLGU();
        }

        function populateAffiliateCards() {
            for (const key in affiliateCardData) {
                const card = affiliateCardData[key];
                const option = document.createElement('option');
                option.value = key;
                option.textContent = card.cardName;
                affiliateCardEl.appendChild(option);
            }
        }

        function updateCardTiers() {
            const selectedCardKey = affiliateCardEl.value;
            cardSpendingTierEl.innerHTML = '';
            if (selectedCardKey === 'none') {
                cardSpendingTierGroupEl.classList.add('hidden');
                return;
            }
            const card = affiliateCardData[selectedCardKey];
            card.tiers.forEach((tier, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = tier.label;
                cardSpendingTierEl.appendChild(option);
            });
            cardSpendingTierGroupEl.classList.remove('hidden');
        }

        function populateCommissionPolicies() {
            commissionPolicyEl.innerHTML = '<option value="none">ì„ íƒ ì•ˆí•¨</option>';
            // Create a set of unique commission values from the rules
            const uniqueCommissions = [...new Set(commissionDataLG.internet_tv.commission_rules.map(rule => rule.commission))];
            // Sort the unique values in descending order for a better user experience
            uniqueCommissions.sort((a, b) => b - a);
            // Populate the dropdown with the unique, sorted commission values
            uniqueCommissions.forEach(commission => {
                const option = document.createElement('option');
                option.value = commission;
                option.textContent = `ìˆ˜ìˆ˜ë£Œ ${commission.toLocaleString()}ì›`;
                commissionPolicyEl.appendChild(option);
            });
        }
        
        function initializeCalculator() {
            populateSelectWithOptionsGeneric(tvPlanEl, lguData.tv_plans);
            populateSelectWithOptionsGeneric(additionalTvPlanEl, lguData.additional_tv_options, "none", "name", "price");
            populateSelectWithOptionsGeneric(phonePlanEl, lguData.phone_plans, "none");
            populateAffiliateCards();
            populateCommissionPolicies();
        
            vatToggle.addEventListener('change', () => {
                isVatIncluded = vatToggle.checked;
                // Re-populate all selects to update prices
                handleInternetTypeChange();
                populateSelectWithOptionsGeneric(tvPlanEl, lguData.tv_plans, tvPlanEl.value);
                populateSelectWithOptionsGeneric(additionalTvPlanEl, lguData.additional_tv_options, additionalTvPlanEl.value, "name", "price");
                populateSelectWithOptionsGeneric(phonePlanEl, lguData.phone_plans, phonePlanEl.value);
                updateMobileLinesInputsLGU();
                // If results are visible, recalculate
                if (!resultSection.classList.contains('hidden')) {
                    calculateAndDisplayResultsLGU();
                }
            });

            internetTypeRadios.forEach(radio => radio.addEventListener('change', handleInternetTypeChange));
            tvPlanEl.addEventListener('change', handleTvPlanChange);
            internetPlanEl.addEventListener('change', () => {
                manageInternetAndDiscountCompatibility();
                handleInternetPlanChange();
                updateAllDiscountDetails();
            });
            mobileLinesCountEl.addEventListener('input', updateMobileLinesInputsLGU);
            affiliateCardEl.addEventListener('change', updateCardTiers);
            calculateButton.addEventListener('click', calculateAndDisplayResultsLGU);
            resetButton.addEventListener('click', resetCalculator);
            generateComparisonButton.addEventListener('click', generateComparisonScript);
            
            // Expert script button listeners
            generateTco100mBtn.addEventListener('click', () => generateTCOComparisonScript('100M'));
            generateTco500mBtn.addEventListener('click', () => generateTCOComparisonScript('500M'));
            generatePenaltyBtn.addEventListener('click', generatePenaltyAnalysisScript);
            generateWaiverBtn.addEventListener('click', generateWaiverScript);

            discountTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'together_bundle' && internetPlanEl.value === '100M') {
                        internetPlanEl.value = '500M';
                        internetPlanEl.dispatchEvent(new Event('change'));
                    }
                    manageInternetAndDiscountCompatibility();
                    updateMobileLineControls();
                    allDetailSectionsLGU.forEach(section => {
                        if (section.radioValue !== this.value) {
                            section.containerEl.classList.add('hidden');
                            section.toggleEl.checked = false;
                        }
                    });
                    updateAllDiscountDetails();
                });
            });
        
            allDetailSectionsLGU.forEach(section => {
                section.toggleEl.addEventListener('change', function() {
                    const radio = document.querySelector(`input[name="discountType"][value="${section.radioValue}"]`);
                    if (radio.checked) {
                        section.containerEl.classList.toggle('hidden', !this.checked);
                        if (this.checked) updateAllDiscountDetails();
                    }
                });
            });
        
            detailsToggleButton.addEventListener('click', () => {
                const isHidden = detailsContainer.classList.toggle('hidden');
                detailsToggleButton.textContent = isHidden ? 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼' : 'ìƒì„¸ ë‚´ì—­ ë‹«ê¸° â–²';
            });
            
            resetCalculator();
        }
        
        function getInternetPlanInfo(internetKey, isBundleInternetType) {
            if (!internetKey || internetKey === "none") return { name: "ë¯¸ì„ íƒ", price: 0, speed_mbps: 0, type: "none" };
            const planDataSource = isBundleInternetType ? lguData.internet_plans.with_tv_base : lguData.internet_plans.standalone;
            const plan = planDataSource[internetKey] || lguData.internet_plans.standalone[internetKey];
            return plan ? { ...plan } : { name: "ì˜¤ë¥˜", price: 0, speed_mbps: 0, type: "none" };
        }
        
        function getDiscountFromBundle(internetTypeKey, discountTypeKeyFromJson, isBundleInternetType, numMobileLines) {
            if (discountTypeKeyFromJson === "none") return 0;

            const internetPlanDetails = getInternetPlanInfo(internetTypeKey, isBundleInternetType);
            if (!internetPlanDetails || !internetPlanDetails.speed_tier) return 0;
            const internetSpeedType = internetPlanDetails.speed_tier;

            const category = isBundleInternetType ? "with_tv" : "standalone_internet";
            const discountsForCategory = lguData.bundle_discounts_on_internet[category];

            if (discountsForCategory?.[internetSpeedType]?.[discountTypeKeyFromJson]) {
                if (discountTypeKeyFromJson === "together_bundle") {
                    const internetSpeedMbps = internetPlanDetails.speed_mbps || 0;
                    const mobilePlanPrices = Array.from(document.querySelectorAll('.mobile-plan-selector')).map(s => parseInt(s.value));
                    const highTierMobileCount = mobilePlanPrices.filter(p => p >= 85000).length;
                    
                    if (internetSpeedMbps >= 500 && highTierMobileCount === numMobileLines && numMobileLines >= 1) {
                        return discountsForCategory[internetSpeedType][discountTypeKeyFromJson].discount;
                    }
                    return 0;
                } else if (discountTypeKeyFromJson === "cham_family") {
                    return numMobileLines > 0 ? discountsForCategory[internetSpeedType][discountTypeKeyFromJson].discount : 0;
                }
                return discountsForCategory[internetSpeedType][discountTypeKeyFromJson].discount;
            }
            return 0;
        }

        function calculatePlanDetails(forcedInternetKey) {
            // --- 1. Get User Inputs ---
            const selectedInternetTypeValue = document.querySelector('input[name="internetType"]:checked').value;
            const isBundleInternetType = selectedInternetTypeValue === 'bundle';
            const internetKey = forcedInternetKey || internetPlanEl.value;
            const tvKey = isBundleInternetType ? tvPlanEl.value : 'none';
            const additionalTvKey = isBundleInternetType ? additionalTvPlanEl.value : 'none';
            const phoneKey = phonePlanEl.value;
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            const selectedDiscountRadio = document.querySelector('input[name="discountType"]:checked');
            const selectedDiscountRadioValue = selectedDiscountRadio.value;
            const selectedDiscountRadioLabel = selectedDiscountRadio.closest('label').textContent.trim();
            const installationTime = document.querySelector('input[name="installationTime"]:checked').value;
            const selectedCardKey = affiliateCardEl.value;
            const selectedCardTierIndex = cardSpendingTierEl.value;
            const commissionPolicyIndex = commissionPolicyEl.value;
            const isInstallationFeeSelfPay = installationFeeSelfPayEl.checked;
        
            // --- 2. Calculate Wired Costs and Discounts ---
            const currentInternetDetails = getInternetPlanInfo(internetKey, isBundleInternetType);
            const internetBasePrice = currentInternetDetails.price;
            let totalActualInternetDiscount = 0;
            if (internetKey !== 'none' && selectedDiscountRadioValue !== "none") {
                 const internetSpeedTypeForDiscount = currentInternetDetails.type.includes('OTT') ? currentInternetDetails.type.split('_')[0] : currentInternetDetails.type;
                if (selectedDiscountRadioValue === "mvno_bundle") {
                    if (numMobileLines > 0 && internetSpeedTypeForDiscount && mvnoBundleConfigFallback.internetDiscount[internetSpeedTypeForDiscount]) {
                        totalActualInternetDiscount = mvnoBundleConfigFallback.internetDiscount[internetSpeedTypeForDiscount];
                    }
                } else {
                    totalActualInternetDiscount = getDiscountFromBundle(internetKey, selectedDiscountRadioValue, isBundleInternetType, numMobileLines);
                }
            }
            totalActualInternetDiscount = Math.min(totalActualInternetDiscount, internetBasePrice);
            
            const tvBase = (isBundleInternetType && tvKey !== 'none' && lguData.tv_plans[tvKey]) ? lguData.tv_plans[tvKey].price : 0;
            const finalAdditionalTvCost = (isBundleInternetType && additionalTvKey !== 'none' && lguData.additional_tv_options[additionalTvKey]) ? lguData.additional_tv_options[additionalTvKey].price : 0;
            const phoneBase = (phoneKey !== 'none' && lguData.phone_plans[phoneKey]) ? lguData.phone_plans[phoneKey].price : 0;
            
            const preDiscountWiredCost = internetBasePrice + tvBase + finalAdditionalTvCost + phoneBase;
            const finalWiredMonthlyCost = preDiscountWiredCost - totalActualInternetDiscount;

            // --- 3. Card Discount ---
            let cardDiscountAmount = 0;
            let selectedCardInfo = null;
            if (selectedCardKey !== 'none' && affiliateCardData[selectedCardKey]) {
                const card = affiliateCardData[selectedCardKey];
                const tier = card.tiers[selectedCardTierIndex];
                if (tier) {
                    cardDiscountAmount = tier.discount;
                    selectedCardInfo = { ...card, selectedTier: tier };
                }
            }
            const finalCostAfterCard = finalWiredMonthlyCost - cardDiscountAmount;
        
            // --- 4. Mobile Discounts ---
            const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                price: parseInt(item.querySelector('.mobile-plan-selector').value),
                selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
            }));
            const mobileDiscounts = getMobileDiscount(selectedDiscountRadioValue, numMobileLines, planInputs);
            
            // --- 5. Other Benefits (Gift & Installation) ---
            let giftCashAmount = 0;
            if (internetKey !== 'none') {
                const isOttPlan = currentInternetDetails.isOttPlan;
                const selectedCommissionValue = parseInt(commissionPolicyEl.value, 10);

                if (isOttPlan && !isNaN(selectedCommissionValue)) {
                    // Determine TV plan tier ('premium' or 'basic')
                    const tvPlanKey = tvPlanEl.value;
                    const tvPlanDetails = tvPlanKey !== 'none' ? lguData.tv_plans[tvPlanKey] : null;
                    const tvTier = (tvPlanDetails && tvPlanDetails.category === 'ë² ì´ì§') ? 'basic' : 'premium';

                    // Find the matching commission rule
                    const rule = commissionDataLG.internet_tv.commission_rules.find(r =>
                        r.commission === selectedCommissionValue && r.plan_tier === tvTier
                    );

                    if (rule) {
                        giftCashAmount = rule.support_money_max || 0;
                    }
                } else if (!isOttPlan) {
                    const giftKeyForCalc = currentInternetDetails.type + (isBundleInternetType ? "ë²ˆë“¤" : "ë‹¨ë…");
                    if (giftTableLGU[giftKeyForCalc]) {
                        giftCashAmount = giftTableLGU[giftKeyForCalc].cash;
                    }
                }
            }

            let calculatedInstallationFee = 0;
            const installType = installationTime === 'weekday' ? 'weekday' : 'weekend';
            const serviceString = getInstallationServiceString(internetKey !== 'none', tvBase > 0, phoneBase > 0, finalAdditionalTvCost > 0);
            if (serviceString) {
                const rulesForDay = installationFeeRules[installType];
                const rule = rulesForDay.find(r => r.service_combination === serviceString);
                if (rule) calculatedInstallationFee = rule.fee;
            }

            let installationFeeSupportAmount = isInstallationFeeSelfPay ? calculatedInstallationFee : 0;

            let productDescriptionForScript = `\n[ìœ ì„  ìƒí’ˆ]`;
            if (currentInternetDetails && currentInternetDetails.name) {
                 productDescriptionForScript += `\nâ–¶ï¸ ${currentInternetDetails.name}`;
                 if(currentInternetDetails.isOttPlan) {
                     productDescriptionForScript += `\nâ–¶ï¸ ì¢…í•©OTT6ì¢… 3ë…„ê°„ ë¬´ìƒì§€ì›(ë„·í”Œë¦­ìŠ¤/í‹°ë¹™/ë””ì¦ˆë‹ˆí”ŒëŸ¬ìŠ¤/ì›¨ì´ë¸Œ/ì¿ íŒ¡í”Œë ˆì´/ì§€ìƒíŒŒë‹¤ì‹œë³´ê¸°/ì´70ë§Œì›ìƒë‹¹)`;
                 }
            } else {
                productDescriptionForScript += `\nâ–¶ï¸ ì¸í„°ë„· ë¯¸ì„ íƒ`;
            }

            if (tvBase > 0 && lguData.tv_plans[tvKey]) {
                productDescriptionForScript += `\nâ–¶ï¸ ${lguData.tv_plans[tvKey].name}`;
            } else {
                productDescriptionForScript += `\nâ–¶ï¸ TV ë¯¸ì„ íƒ`;
            }
             if (finalAdditionalTvCost > 0 && lguData.additional_tv_options[additionalTvKey]) {
                productDescriptionForScript += `\nâ–¶ï¸ (ì¶”ê°€) ${lguData.additional_tv_options[additionalTvKey].name}`;
            }

            if (phoneBase > 0 && lguData.phone_plans[phoneKey]) {
                productDescriptionForScript += `\nâ–¶ï¸ ${lguData.phone_plans[phoneKey].name}`;
            } else {
                productDescriptionForScript += `\nâ–¶ï¸ ì§‘ì „í™” ë¯¸ì„ íƒ`;
            }

            productDescriptionForScript += `\nâ–¶ï¸ WiFi ê³µìœ ê¸°`;


            return {
                preDiscountWiredCost,
                finalWiredMonthlyCost,
                finalCostAfterCard,
                totalActualInternetDiscount,
                cardDiscountAmount,
                selectedCardInfo,
                giftCashAmount,
                totalMobileDiscount: mobileDiscounts.total,
                calculatedInstallationFee,
                installationFeeSupportAmount,
                productDescriptionForScript,
                internetDetails: currentInternetDetails,
                tvDetails: tvBase > 0 ? lguData.tv_plans[tvKey] : null,
                additionalTvDetails: finalAdditionalTvCost > 0 ? lguData.additional_tv_options[additionalTvKey] : null,
                phoneDetails: phoneBase > 0 ? lguData.phone_plans[phoneKey] : null,
                numMobileLines,
                discountTypeName: selectedDiscountRadioLabel,
                discountTypeValue: selectedDiscountRadioValue,
                isVatIncluded
            };
        }

        function calculateAndDisplayResultsLGU() {
            const results = calculatePlanDetails(); 
            
            preDiscountWiredFeeEl.textContent = formatPrice(results.preDiscountWiredCost);
            finalWiredFeeEl.textContent = formatPrice(results.finalWiredMonthlyCost);
            cardDiscountEl.textContent = formatPrice(results.cardDiscountAmount);
            giftAmountEl.textContent = results.giftCashAmount.toLocaleString();
            mobileDiscountEl.textContent = formatPrice(results.totalMobileDiscount);
        
            totalBaseWiredCostEl.textContent = formatPrice(results.preDiscountWiredCost);
            totalInternetDiscountAmountEl.textContent = formatPrice(results.totalActualInternetDiscount);
            totalCardDiscountAmountEl.textContent = formatPrice(results.cardDiscountAmount);
            
            finalMonthlyCostEl.textContent = formatPrice(results.finalCostAfterCard);
            
            selectedInternetEl.textContent = results.internetDetails.name;
            selectedTvEl.textContent = results.tvDetails?.name || 'ë¯¸ì„ íƒ';
            selectedAdditionalTvEl.textContent = results.additionalTvDetails?.name || 'ë¯¸ì„ íƒ';
            selectedPhoneEl.textContent = results.phoneDetails?.name || 'ë¯¸ì„ íƒ';
            selectedMobileCountEl.textContent = results.numMobileLines;
            
            selectedDiscountTypeEl.textContent = results.discountTypeName;
            
            installationCostResultEl.textContent = formatPrice(results.calculatedInstallationFee);
            giftCashEl.textContent = results.giftCashAmount.toLocaleString();
            
            resultSection.classList.remove('hidden');
            messageScriptSectionEl.classList.remove('hidden');
            expertScriptSectionEl.classList.remove('hidden');
            
            generateMessageScriptsLGU(); 
        }

        function generateComparisonScript() {
            const results100M = calculatePlanDetails('100M');
            const results500M = calculatePlanDetails('500M');

            if (!results100M || !results500M) {
                alert("ë¹„êµ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                return;
            }

            const vatText = results100M.isVatIncluded ? "VATí¬í•¨" : "VATë³„ë„";

            // Use adjustForVat for calculations, formatPrice for display
            const monthlyCost100M = adjustForVat(results100M.finalWiredMonthlyCost);
            const monthlyCost500M = adjustForVat(results500M.finalWiredMonthlyCost);
            const gift100M = results100M.giftCashAmount;
            const gift500M = results500M.giftCashAmount;

            const monthlyCostDifference = monthlyCost500M - monthlyCost100M;
            const giftDifference = gift500M - gift100M;
            
            const discountTypeName = results100M.discountTypeName; // Should be the same for both

            const comparisonScript = `[ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„°] 100Mbps vs 500Mbps ìƒí’ˆ ë¹„êµ ì•ˆë‚´ (${vatText})

ê³ ê°ë‹˜ê»˜ì„œ ì„ íƒí•˜ì‹  ì˜µì…˜ ê¸°ì¤€ìœ¼ë¡œ, ì¸í„°ë„· ì†ë„ë§Œ ë³€ê²½í–ˆì„ ë•Œì˜ ìš”ê¸ˆê³¼ í˜œíƒì„ ë¹„êµí•´ ë“œë¦½ë‹ˆë‹¤.

----- 100M -----
${results100M.productDescriptionForScript.trim()}

[ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ]
â–¶ï¸ ì›” ${formatPrice(results100M.finalWiredMonthlyCost)}ì› (${discountTypeName})
â–¶ï¸ ì‚¬ì€í’ˆ ${gift100M.toLocaleString()}ì›

----- 500M -----
${results500M.productDescriptionForScript.trim()}

[ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ]
â–¶ï¸ ì›” ${formatPrice(results500M.finalWiredMonthlyCost)}ì› (${discountTypeName})
â–¶ï¸ ì‚¬ì€í’ˆ ${gift500M.toLocaleString()}ì›
--------------------

ê³ ê°ë‹˜, í˜¹ì‹œ ì•Œê³  ê³„ì…¨ë‚˜ìš”?
ì§€ê¸ˆ ì„ íƒí•˜ì‹  100Mbps ìš”ê¸ˆì— ì›” ${monthlyCostDifference.toLocaleString()}ì›ë§Œ ì¶”ê°€í•˜ì‹œë©´,
âœ… ì¸í„°ë„· ì†ë„ëŠ” 5ë°° ë¹¨ë¼ì§€ê³ ,
âœ… ì²« ë‹¬ì— ë°›ìœ¼ì‹œëŠ” ì‚¬ì€í’ˆì€ ${(giftDifference / 10000).toLocaleString()}ë§Œì› ë” ì»¤ì§‘ë‹ˆë‹¤!

ì˜¨ ê°€ì¡±ì´ ë™ì‹œì— ì ‘ì†í•´ë„ ëŠê¹€ ì—†ëŠ” 500Mbps ìƒí’ˆìœ¼ë¡œ ë³€ê²½ ì›í•˜ì‹œë©´ í¸í•˜ê²Œ ë§ì”€í•´ì£¼ì„¸ìš”. ğŸ˜Š`;

            infoScriptEl.value = comparisonScript.trim();
            alert('100M vs 500M ë¹„êµ ìŠ¤í¬ë¦½íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        function generateMessageScriptsLGU() {
            const results = calculatePlanDetails();
            const vatText = results.isVatIncluded ? "VATí¬í•¨" : "VATë³„ë„";
        
            const memoAdditions = `ì´ë¦„
í•¸ë“œí° ë²ˆí˜¸
í•¸ë“œí° í†µì‹ ì‚¬
ì£¼ë¯¼ë²ˆí˜¸
ì„¤ì¹˜í•  ì£¼ì†Œ
ì‚¬ì€í’ˆ ë°›ì„ ê³„ì¢Œë²ˆí˜¸
ì‚¬ì€í’ˆ(ìƒ/í˜„)/ ìì²´ì§€ê¸‰
ìƒí’ˆì •ë³´
ì²­êµ¬ ê¸ˆì•¡
ì œíœ´ì¹´ë“œ ë°˜ì˜ì‹œ
ì„¤ì¹˜ë¹„ ì•ˆë‚´ì™„
ì¸ì¦ì—°ë½30ë¶„í›„ ê°€ëŠ¥
ì„¤ì¹˜ì¼ì •
ê¸°ì¡´ì‚¬ìš© ì¸í„°ë„· í†µì‹ ì‚¬`;

            memoScriptEl.value = `1. ìƒí’ˆ : ${results.productDescriptionForScript.replace(/\nâ–¶ï¸ /g, ' + ').replace('[ìœ ì„  ìƒí’ˆ]\n + ','')}
2. ìš”ê¸ˆ : í• ì¸ì „(${formatPrice(results.preDiscountWiredCost)}ì›) / í• ì¸í›„(${formatPrice(results.finalWiredMonthlyCost)}ì›) / ì¹´ë“œí• ì¸í›„(${formatPrice(results.finalCostAfterCard)}ì›)
3. ê²°í•©í• ì¸ìœ í˜• : ${results.discountTypeName}
4. ì‚¬ì€í’ˆ : í˜„ê¸ˆ ${results.giftCashAmount.toLocaleString()}ì›
5. ì„¤ì¹˜ë¹„ : ${formatPrice(results.calculatedInstallationFee)}ì›
6. ê¸°íƒ€ : ì´ì‚¬ ì—¬ë¶€ [  ] / í¬ë§ì„¤ì¹˜ì¼ì [     ë…„  ì›”  ì¼]
---
${memoAdditions}`;
        
            let infoScriptText = `[ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„°] ìƒí’ˆ & ì‚¬ì€í’ˆ ìš”ì•½ ì•ˆë‚´
    ì•ˆë…•í•˜ì„¸ìš”, ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„° ì…ë‹ˆë‹¤.
    ê³ ê°ë‹˜ê»˜ì„œ ì˜¤ëŠ˜ ìƒë‹´ ë°›ìœ¼ì‹  ìƒí’ˆ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
    ${results.productDescriptionForScript}

[ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ]
    â–¶ï¸ ì›” ${formatPrice(results.finalWiredMonthlyCost)}ì› (ì´ì•¡ ê²°í•©í• ì¸, ${vatText})`;

            if (results.installationFeeSupportAmount > 0) {
                infoScriptText += `\n    â–¶ï¸ ì„¤ì¹˜ë¹„ ì§€ì›(ìì²´ì§€ê¸‰) ${results.installationFeeSupportAmount.toLocaleString()}ì› (í™•ì •)`;
            }
            infoScriptText += `\n    â–¶ï¸ ì‚¬ì€í’ˆ ${results.giftCashAmount.toLocaleString()}ì› (í™•ì •)`;

            const finalWiredMonthlyCostAdjusted = adjustForVat(results.finalWiredMonthlyCost);
            const cardDiscountAdjusted = adjustForVat(results.cardDiscountAmount);
            const finalCostAfterCardAdjusted = adjustForVat(results.finalCostAfterCard);

            if (results.selectedCardInfo) {
                infoScriptText += `\n    â–¶ï¸ ê¸°ì¡´ ì›” ${finalWiredMonthlyCostAdjusted.toLocaleString()}ì› - ì¹´ë“œ ìë™ì´ì²´ ì²­êµ¬ í• ì¸ ${cardDiscountAdjusted.toLocaleString()}ì›`;
                infoScriptText += `\n    = âœ¨ ìµœì¢… ì›” ë‚©ë¶€ì•¡ ${finalCostAfterCardAdjusted.toLocaleString()}ì›! âœ¨ (âš ï¸${vatText})`;
            } else {
                infoScriptText += `\n    = âœ¨ ìµœì¢… ì›” ë‚©ë¶€ì•¡ ${finalWiredMonthlyCostAdjusted.toLocaleString()}ì›! âœ¨ (âš ï¸${vatText})`;
            }
            
            infoScriptText += `

    * í˜œíƒì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°”ë€” ìˆ˜ ìˆë‹¤ëŠ” ì  ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
    * 3ë…„ ì•½ì • ê¸°ì¤€
    ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„° ë“œë¦¼. â¤ï¸`;

            infoScriptEl.value = infoScriptText;
        
            let finalGuidance = '';
            if (results.discountTypeValue !== 'none') {
                 finalGuidance = `\n\nâš ï¸ [í•„ë…] ì›” ìš”ê¸ˆ í• ì¸ì„ ìœ„í•œ ë§ˆì§€ë§‰ ë‹¨ê³„!
ê³ ê°ë‹˜, ì„ íƒí•˜ì‹  '${results.discountTypeName}' í• ì¸ì€ ì¸í„°ë„· ì„¤ì¹˜ ì™„ë£Œ í›„, ê³ ê°ë‹˜ê»˜ì„œ ì§ì ‘ U+ ê³ ê°ì„¼í„°(101ë²ˆ)ë¡œ ì „í™”í•˜ì‹œì–´ "ê²°í•© ì‹ ì²­"ì„ í•˜ì…”ì•¼ ìµœì¢… ì ìš©ë©ë‹ˆë‹¤. ìŠì§€ ë§ê³  ê¼­ ì‹ ì²­í•˜ì…”ì„œ í• ì¸ í˜œíƒì„ ë°›ìœ¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤!`;
            }

            let completeProductDescription = results.productDescriptionForScript.replace('[ìœ ì„  ìƒí’ˆ]\n', '');
            let completeDiscountLine = results.discountTypeName !== 'ê²°í•©í• ì¸ ì—†ìŒ' ? `\nâ–¶ï¸ ê²°í•©í• ì¸ìœ í˜• : ${results.discountTypeName}` : '';
        
            completeScriptEl.value = `[ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„°] U+ ê°€ì… ì™„ë£Œ ì•ˆë‚´\nì•ˆë…•í•˜ì„¸ìš”, ê³ ê°ë‹˜. ì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„° U+ì…ë‹ˆë‹¤.\nâœ… ê³„ì•½ì´ ì™„ë£Œë˜ì—ˆì–´ìš”, ì•„ë˜ ë‚´ìš©ì€ ê³„ì•½ì„œì™€ ë™ì¼í•œ íš¨ë ¥ì´ ìˆìœ¼ë‹ˆ ê¼¼ê¼¼íˆ ì½ì–´ì£¼ì„¸ìš”.\nâš ï¸ 3ë…„ ì•½ì •ì´ë©°, ì•„ë˜ì™€ ê°™ì€ ìƒí™©ì— í•´ë‹¹í•˜ë©´ ë°›ìœ¼ì…¨ë˜ ì‚¬ì€í’ˆì€ í™˜ìˆ˜ ë©ë‹ˆë‹¤.\nâ‘  1ë…„ ì´ë‚´ í•´ì§€/ì •ì§€/ëª…ì˜ë³€ê²½\nâ‘¡ ìš”ê¸ˆ ë¯¸ë‚© ë° ì‚¬ìš©ì •ì§€\nâ‘¢ ìš”ê¸ˆì œ í•˜í–¥ (ìƒí–¥ ì‹œì—ëŠ” í™˜ìˆ˜ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤!)\nâ‘£ ê°œí†µ 1ê°œì›” ì´ë‚´ ê²°ì œìˆ˜ë‹¨ ì§€ë¡œì²­êµ¬ì„œë¡œ ë³€ê²½\nâš ï¸ ì‹ ê·œ ê°€ì… í›„ ê¸°ì¡´ì— ì‚¬ìš©í•˜ì‹œë˜ íƒ€ì‚¬ ì¸í„°ë„·/TVëŠ” ê¼­ ì§ì ‘ í•´ì§€ í•´ì£¼ì„¸ìš”. ìë™í•´ì§€ë˜ì§€ ì•Šìœ¼ë©° ì´ëŸ´ ê²½ìš° ìš”ê¸ˆì´ ì´ì¤‘ ë¶€ê³¼ë˜ì–´ìš”.\nâš ï¸ 3ë…„ ì´ë‚´ í•´ì§€ ì‹œ í†µì‹ ì‚¬ ë³¸ì‚¬ì— ìœ„ì•½ê¸ˆ (í• ì¸ ë°˜í™˜ê¸ˆ) ë° ë©´ì œëœ ì„¤ì¹˜ë¹„/ì¥ë¹„ì„ëŒ€ë£Œ ë“±ì´ ë°˜í™˜ë  ìˆ˜ ìˆì–´ìš”.\nâœ… ê°€ì… ìƒí’ˆ ì•ˆë‚´\n${completeProductDescription}${completeDiscountLine}\nâ–¶ï¸ ì›” ${formatPrice(results.finalWiredMonthlyCost)}ì› (ìœ ì„ ìƒí’ˆ, 3ë…„ ì•½ì •, ${vatText})\nâ–¶ï¸ ì„¤ì¹˜ë¹„ ${formatPrice(results.calculatedInstallationFee)}ì› ì²« ë‹¬ í•©ì‚° ì²­êµ¬\nâ–¶ï¸ í˜„ê¸ˆ ì‚¬ì€í’ˆ ${results.giftCashAmount.toLocaleString()}ì›\nâœ…ì‚¬ì€í’ˆì€ ì„¤ì¹˜ í›„ í‰ì¼ ê¸°ì¤€ ìµì£¼ ê¸ˆìš”ì¼ê¹Œì§€ ì§€ê¸‰ë©ë‹ˆë‹¤. (ì„¤ì¹˜ í›„ ì—°ë½ í•„ìˆ˜)\n${finalGuidance}\nì›¨ì´íŒ… ì¸í„°ë„· í†µí•©ì ‘ìˆ˜ì„¼í„° ë“œë¦¼.`;
        
            sensitiveInfoLinkScriptEl.value = `[LG] ì•„ë˜ ë§í¬ì— ê³ ê°ë‹˜ì˜ ë¯¼ê°ì •ë³´ë¥¼ ì…ë ¥í•˜ì‹œë©´ LGë¡œ ê³ ê°ë‹˜ì˜ ë¯¼ê°ì •ë³´ê°€ ì§ì ‘ ì „ì†¡í›„ ì ‘ìˆ˜ ë©ë‹ˆë‹¤.\n\nhttps://lg-sensitiveinfo.com/\n\nì…ë ¥í›„ ì ‘ìˆ˜ ì™„ë£Œ ë¼ê³  ë¬¸ì ì£¼ì‹œë©´ ë‹´ë‹¹ ìƒë‹´ì›ì´ ì ‘ìˆ˜ í™•ì¸í›„ í•„ìˆ˜ ì•ˆë‚´ì‚¬í•­ ì•ˆë‚´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        
            mvnoInfoScriptEl.value = 'U+ì•Œëœ°ëª¨ë°”ì¼ ì¸í„°ë„· ê²°í•© ìš”ê¸ˆì œ ì •ë³´: https://www.uplusmvno.com/plan/plan-list';
        }

        function generateTCOComparisonScript(speed) {
            const data = tcoData[speed]?.lgu;
            if (!data) {
                tcoScriptEl.value = `${speed} ì†ë„ì— ëŒ€í•œ TCO ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.`;
                return;
            }

            const savings13 = data.oneYearTCO13 - data.threeYearTCO13;
            const savings18 = data.oneYearTCO18 - data.threeYearTCO18;

            tcoScriptEl.value = `1ë…„ vs 3ë…„ ì•½ì • ì´ë¹„ìš©(TCO) ë¹„êµ (${speed})

"ê³ ê°ë‹˜, ì•½ì • ê¸°ê°„ì´ ë¶€ë‹´ë˜ì‹œëŠ” ë§ˆìŒ ì¶©ë¶„íˆ ì´í•´í•©ë‹ˆë‹¤.
ê·¸ë˜ì„œ ê³µì‹ ì•½ê´€ ê¸°ì¤€ìœ¼ë¡œ ì‹¤ì œ ì´ë¹„ìš©ì„ ë¹„êµí•œ ìë£Œë¥¼ ë³´ë‚´ë“œë ¸ìŠµë‹ˆë‹¤.
ë†€ëê²Œë„, 3ë…„ ì•½ì •ì€ 1ë…„(13ê°œì›”)ë§Œ ì‚¬ìš©í•˜ê³  í•´ì§€í•´ë„ 1ë…„ ì•½ì •ë³´ë‹¤ í›¨ì”¬ ì €ë ´í•©ë‹ˆë‹¤."

â–  ${speed} ìƒí’ˆ, 1ë…„ë§Œ ì¨ë„ 3ë…„ ì•½ì •ì´ ì´ë“!
- 13ê°œì›” ì‚¬ìš© í›„ í•´ì§€ ì‹œ: 1ë…„ ì•½ì •ë³´ë‹¤ ì´ ${savings13.toLocaleString()}ì› ì´ë“!
- 18ê°œì›” ì‚¬ìš© í›„ í•´ì§€ ì‹œ: 1ë…„ ì•½ì •ë³´ë‹¤ ì´ ${savings18.toLocaleString()}ì› ì´ë“!

ì•„ë˜ëŠ” ìœ„ì•½ê¸ˆê¹Œì§€ ëª¨ë‘ í¬í•¨ëœ ì‹¤ì œ ì´ ë¶€ë‹´ ê¸ˆì•¡(TCO)ì…ë‹ˆë‹¤.

| êµ¬ë¶„        | ì›” ìš”ê¸ˆ(VAT í¬í•¨) | ì‚¬ì€í’ˆ   | 13ê°œì›” ì‚¬ìš© ì‹œ ì´ë¹„ìš©(TCO) | 18ê°œì›” ì‚¬ìš© ì‹œ ì´ë¹„ìš©(TCO) |
|--------------|-------------------|----------|----------------------------|----------------------------|
| 1ë…„ ì•½ì •     | ${data.oneYearFee.toLocaleString()}ì›        | -        | **${data.oneYearTCO13.toLocaleString()}ì›** | **${data.oneYearTCO18.toLocaleString()}ì›** |
| 3ë…„ ì•½ì •     | ${data.threeYearFee.toLocaleString()}ì›        | ${data.threeYearGift.toLocaleString()}ì› | **${data.threeYearTCO13.toLocaleString()}ì›** (ğŸ‘‰${(savings13/10000).toFixed(1)}ë§Œì› ì´ë“) | **${data.threeYearTCO18.toLocaleString()}ì›** (ğŸ‘‰${(savings18/10000).toFixed(1)}ë§Œì› ì´ë“) |

*TCO(Total Cost of Ownership): ì›” ìš”ê¸ˆ, ì‚¬ì€í’ˆ, í•´ì§€ ìœ„ì•½ê¸ˆ ë“± ëª¨ë“  ë¹„ìš©ì„ ì¢…í•©í•˜ì—¬ ê³ ê°ì´ ì‹¤ì œë¡œ ë¶€ë‹´í•˜ëŠ” ì´ ì†Œìœ  ë¹„ìš©.

[ì¶œì²˜ ì•ˆë‚´]
* LGU+: lguplus.com > ì¸í„°ë„·/IPTV > í• ì¸ë°˜í™˜ê¸ˆì•ˆë‚´ (https://www.lguplus.com/internet-iptv/popup/PaybackPop)`;
        }

        function generatePenaltyAnalysisScript() {
            penaltyScriptEl.value = penaltyAnalysisData.text;
        }

        function generateWaiverScript() {
            waiverScriptEl.value = waiverConditionsData.text;
        }

        function getInstallationServiceString(hasInternet, hasFirstTv, hasPhone, hasAdditionalTv) {
            if (!hasInternet) return null;
            if (hasFirstTv && hasAdditionalTv) return "ì¸í„°ë„· + TV + TVì¶”ê°€";
            if (hasFirstTv && hasPhone) return "ì¸í„°ë„· + TV + ì¼ë°˜/070ì „í™”"; 
            if (hasFirstTv) return "ì¸í„°ë„· + TV";
            if (hasPhone) return "ì¸í„°ë„· + ì¸í„°ë„·ì „í™”"; 
            return "ì¸í„°ë„·";
        }
        
        function copyToClipboard(elementId, feedbackElementId) {
            const textarea = document.getElementById(elementId);
            const feedbackEl = document.getElementById(feedbackElementId);
            
            textarea.select();
            textarea.setSelectionRange(0, 99999);

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    feedbackEl.textContent = 'ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!';
                    setTimeout(() => { feedbackEl.textContent = ''; }, 2000);
                } else {
                    feedbackEl.textContent = 'ë³µì‚¬ ì‹¤íŒ¨';
                     setTimeout(() => { feedbackEl.textContent = ''; }, 2000);
                }
            } catch (err)
 {
                feedbackEl.textContent = 'ë³µì‚¬ ì˜¤ë¥˜';
                setTimeout(() => { feedbackEl.textContent = ''; }, 2000);
            }

            window.getSelection().removeAllRanges();
        }
        
        function manageInternetAndDiscountCompatibility() {
            const internetKey = internetPlanEl.value;
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            const togetherBundleRadio = document.querySelector('input[name="discountType"][value="together_bundle"]');
            const togetherBundleLabel = togetherBundleRadio.closest('label.radio-label'); 
            const option100M = internetPlanEl.querySelector('option[value="100M"]');

            if (internetKey === '100M') {
                togetherBundleRadio.disabled = true;
                if (togetherBundleLabel) togetherBundleLabel.classList.add('opacity-50', 'cursor-not-allowed');

                if (selectedDiscount === 'together_bundle') {
                    document.querySelector('input[name="discountType"][value="none"]').checked = true;
                    document.querySelector('input[name="discountType"][value="none"]').dispatchEvent(new Event('change'));
                }
            } else {
                togetherBundleRadio.disabled = false;
                if (togetherBundleLabel) togetherBundleLabel.classList.remove('opacity-50', 'cursor-not-allowed');
            }

            if (option100M) {
                const currentSelectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
                option100M.disabled = currentSelectedDiscount === 'together_bundle';
            }
        }

        document.addEventListener('DOMContentLoaded', initializeCalculator);
    </script>
</body>
</html>

